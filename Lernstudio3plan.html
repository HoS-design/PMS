<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HoS Lernstudio ‚Äì Wissens-App (Complete Edition)</title>
  <style>
    :root{
      /* -- Farbpalette: Modern, Clean, Friendly -- */
      --bg: #f2f4f7;           
      --surface: #ffffff;      
      --card: #ffffff;         
      
      --ink: #1e293b;          
      --muted: #64748b;        
      --line: #e2e8f0;         
      
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
      --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.08), 0 2px 4px -1px rgba(0,0,0,0.04);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.08), 0 4px 6px -2px rgba(0,0,0,0.04);

      /* -- Akzentfarben -- */
      --accent: #3b82f6;       
      --accent-soft: #eff6ff;
      --accent2: #10b981;      
      --warn: #f59e0b;         
      --danger: #ef4444;       
      
      --radius: 20px;
      --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--font-sans);
      color: var(--ink);
      background: var(--bg);
      -webkit-font-smoothing: antialiased;
    }

    a{color:inherit; text-decoration:none}
    
    /* -- Layout -- */
    .app{
      display:grid;
      grid-template-columns: 360px 1fr;
      min-height:100vh;
    }
    @media (max-width: 980px){
      .app{grid-template-columns: 1fr}
      .sidebar{position:sticky; top:0; z-index:50}
    }

    /* -- Sidebar -- */
    .sidebar{
      background: var(--surface);
      border-right: 1px solid var(--line);
      display:flex; flex-direction:column;
      height:100vh;
      overflow:hidden;
    }
    .side-inner{
      padding:24px 20px; 
      height:100%; 
      overflow-y:auto; 
      display:flex; flex-direction:column; gap:20px;
    }

    /* LOGO BEREICH */
    .brand{ padding-bottom: 20px; border-bottom: 1px solid var(--line); }
    .brand-row { display:flex; align-items:center; gap:16px; }
    .logo-img { width:60px; height:60px; object-fit:contain; border-radius:12px; background:#f8fafc; border:1px solid var(--line); }
    
    .badge-main{
      display:inline-flex; align-items:center; gap:6px;
      background: var(--ink); color: white;
      font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;
      padding:4px 8px; border-radius:99px; margin-bottom:6px;
    }
    .brand h1{ margin:0; font-size:20px; font-weight:800; letter-spacing:-0.5px; line-height:1.2; }
    .brand p{ margin:8px 0 0; font-size:13px; color:var(--muted); line-height:1.4; }

    .search-box{ position:relative; }
    .search-box input{
      width:100%; padding:12px 16px 12px 42px;
      border: 1px solid var(--line); border-radius: 12px;
      background: var(--bg); font-size:14px; color:var(--ink); transition: all 0.2s;
    }
    .search-box input:focus{ outline:none; border-color: var(--accent); background: white; box-shadow: 0 0 0 3px var(--accent-soft); }
    .search-icon{ position:absolute; left:14px; top:50%; transform:translateY(-50%); font-size:16px; opacity:0.5; pointer-events:none; }

    .filters{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
      font-size:12px; font-weight:600; padding:6px 12px; border-radius:99px; cursor:pointer;
      background: white; border: 1px solid var(--line); color: var(--muted); transition: all 0.15s;
    }
    .chip:hover{ background: var(--bg); color:var(--ink); }
    .chip.active{ background: var(--ink); color: white; border-color: var(--ink); }

    .list-header{ display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:8px; font-size:12px; font-weight:700; text-transform:uppercase; color:var(--muted); letter-spacing:0.5px; }
    .items{ flex:1; display:flex; flex-direction:column; gap:8px; }
    .item{
      display:flex; align-items:flex-start; gap:12px; padding:12px; border-radius: 12px;
      background: transparent; border: 1px solid transparent; cursor:pointer; transition: all 0.15s;
    }
    .item:hover{ background: var(--bg); }
    .item.active{ background: white; border-color: var(--line); box-shadow: var(--shadow-sm); }
    .item .code{
      font-family: var(--font-mono); font-weight:700; font-size:11px;
      background: var(--bg); color: var(--muted); padding:4px 8px; border-radius:6px;
      min-width:36px; text-align:center; margin-top:2px;
    }
    .item.active .code{ background: var(--accent); color:white; }
    .item .content{ flex:1; }
    .item .title{ font-size:14px; font-weight:700; color:var(--ink); line-height:1.3; }
    .item .desc{ font-size:12px; color:var(--muted); margin-top:4px; line-height:1.4; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;}

    /* -- Main Area -- */
    .main{ padding: 32px 40px; max-width: 1000px; margin: 0 auto; width:100%; }
    @media (max-width: 980px){ .main{padding:20px} }

    .topbar{ display:flex; align-items:center; justify-content:space-between; gap:20px; margin-bottom:24px; }
    .crumb{ font-size:13px; color:var(--muted); display:flex; align-items:center; gap:8px; }
    .crumb b{color:var(--ink); background:white; padding:2px 8px; border-radius:6px; border:1px solid var(--line)}
    
    .btns{ display:flex; gap:10px; }
    .btn{
      border:1px solid var(--line); background: white; color: var(--ink);
      font-size:13px; font-weight:600; padding:8px 16px; border-radius: 10px;
      cursor:pointer; box-shadow: var(--shadow-sm); transition: all 0.2s;
    }
    .btn:hover{ transform:translateY(-1px); box-shadow:var(--shadow-md); }
    .btn:active{ transform:translateY(0); }
    .btn.primary{ background: var(--ink); color:white; border-color:var(--ink); }

    .card{ background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow-md); border: 1px solid rgba(0,0,0,0.03); overflow:hidden; margin-bottom:40px; }
    .card-head{
      padding: 24px 32px; border-bottom: 1px solid var(--line);
      background: linear-gradient(to bottom, #ffffff, #fafafa);
      display:flex; justify-content:space-between; align-items:flex-start; gap:20px;
    }
    .card-head h2{ margin:0; font-size:24px; letter-spacing:-0.5px; }
    .card-head .code{ color: var(--accent); font-family:var(--font-mono); margin-right:8px; }
    .card-head .subtitle{ margin:8px 0 0; color:var(--muted); font-size:14px; line-height:1.5; max-width:600px; }
    .card-body{ padding:32px; }

    .grid-2{ display:grid; grid-template-columns: 1.2fr 1fr; gap:24px; }
    @media (max-width: 800px){ .grid-2{grid-template-columns:1fr} }

    .box{ background: #f8fafc; border: 1px solid var(--line); border-radius: 16px; padding:20px; }
    .box h3{ margin:0 0 12px; font-size:15px; font-weight:700; color:var(--ink); display:flex; align-items:center; gap:8px;}
    .box p, .box li{ font-size:14px; line-height:1.6; color: #334155; }
    .box ul{ margin:0; padding-left:20px; }
    .box li{ margin-bottom:6px; }

    .rule-box{ background: var(--accent-soft); border-left: 4px solid var(--accent); padding:16px; border-radius: 8px; margin: 16px 0; color: var(--ink); font-size:14px; line-height:1.5; }
    .warn-box{ background: #fffbeb; border-left: 4px solid var(--warn); padding:16px; border-radius: 8px; margin: 16px 0; color: #92400e; font-size:14px; line-height:1.5; }
    
    .svg-wrap{
      background: white; border: 1px solid var(--line); border-radius: 16px; padding:16px;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.03); display:flex; justify-content:center;
    }

    .quiz-item{ background: white; border: 1px dashed #cbd5e1; border-radius: 12px; padding:16px; margin-bottom:12px; }
    .quiz-q{ font-weight:700; font-size:14px; margin-bottom:12px; display:block; }
    .quiz-opts{ display:flex; flex-wrap:wrap; gap:8px; }
    .opt{
      background: white; border:1px solid var(--line); padding:6px 12px; border-radius:8px;
      font-size:13px; font-weight:600; color:var(--muted); cursor:pointer; user-select:none;
      transition: all 0.1s; box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    .opt:hover{ border-color:var(--accent); color:var(--accent); }
    .opt.good{ border-color:var(--accent2); background:#ecfdf5; color:#065f46; }
    .opt.bad{ border-color:var(--danger); background:#fef2f2; color:#991b1b; }
    .area-pill{
      display:inline-flex; align-items:center; gap:6px; font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;
      padding:6px 12px; border-radius:99px; background: var(--bg); color: var(--muted); border: 1px solid var(--line);
    }

    /* Grammatik-Tabellen */
    .g-table{ width:100%; border-collapse:collapse; font-size:14px; margin-top:10px; }
    .g-table th{ text-align:left; border-bottom:2px solid var(--line); padding:8px; color:var(--muted); font-size:12px; text-transform:uppercase; }
    .g-table td{ border-bottom:1px solid var(--line); padding:10px 8px; vertical-align:top; }
    .g-table tr:last-child td{ border:none; }
    .g-hl{ color:var(--accent); font-weight:700; }

    .tile-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:20px; }
    .tile{
      background: white; border: 1px solid var(--line); border-radius: 16px; padding:20px; cursor:pointer; transition: all 0.2s; box-shadow: var(--shadow-sm);
      display:flex; flex-direction:column; justify-content:space-between; height:100%;
    }
    .tile:hover{ transform:translateY(-3px); box-shadow:var(--shadow-lg); border-color: var(--accent); }
    .tile h3{ margin:0 0 8px; font-size:16px; }
    .tile p{ margin:0; font-size:13px; color:var(--muted); line-height:1.4; }
    
    .footer-note{ margin-top:40px; text-align:center; color:var(--muted); font-size:12px; }
    @media print{ .sidebar, .btns{display:none} .app{display:block} .main{padding:0; max-width:none} .card{box-shadow:none; border:1px solid #000} }
  </style>
</head>
<body>

  <div class="app">
    <aside class="sidebar">
      <div class="side-inner">
        <div class="brand">
          <div class="brand-row">
            <img src="chatisthisreal.png" alt="Logo" class="logo-img" onerror="this.style.display='none'">
            <div>
              <div class="badge-main">HoS Lernstudio</div>
              <h1>Plan-Module</h1>
            </div>
          </div>
          <p>Wissens-App v1.0 (Complete)</p>
        </div>

        <div class="search-box">
          <span class="search-icon">üîé</span>
          <input id="searchInput" type="search" placeholder="Suche (z.B. Passiv, S2, Argumente)‚Ä¶" autocomplete="off">
        </div>
        <div class="filters">
          <div class="chip active" data-filter="ALL">Alle</div>
          <div class="chip" data-filter="S">Schreiben</div>
          <div class="chip" data-filter="G">Grammatik</div>
          <div class="chip" data-filter="R">Rechtschr.</div>
        </div>
        <div class="items-wrap" style="flex:1; overflow:hidden; display:flex; flex-direction:column;">
          <div class="list-header">
            <span>Module</span>
            <span style="font-family:var(--font-mono)"><span id="countNow">0</span>/<span id="countAll">0</span></span>
          </div>
          <div id="items" class="items" style="overflow-y:auto; padding-bottom:20px"></div>
        </div>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="crumb" id="crumb"><span>Start</span><span>‚Ä∫</span><b>√úbersicht</b></div>
        <div class="btns">
          <button class="btn" id="homeBtn">üè† Start</button>
          <button class="btn" id="printBtn">üñ®Ô∏è PDF</button>
          <button class="btn primary" id="copyLinkBtn">üîó Link</button>
        </div>
      </div>
      <div id="view"></div>
      <p class="footer-note">HoS Lernstudio ‚Ä¢ Lernen mit Struktur</p>
    </main>
  </div>

  <script>
    // ---------- Utilities ----------
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
    const escapeHTML = (s) => (s||"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
    function normalize(s){ return (s||"").toString().toLowerCase().replace(/√§/g,"ae").replace(/√∂/g,"oe").replace(/√º/g,"ue").replace(/√ü/g,"ss"); }
    function setHash(id){ history.replaceState(null, "", id ? ("#"+id) : "#"); }
    function currentHash(){ return (location.hash||"").replace("#","").trim(); }
    function copyToClipboard(text){
      if(navigator.clipboard?.writeText) return navigator.clipboard.writeText(text);
      const ta = document.createElement("textarea"); ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand("copy"); ta.remove(); return Promise.resolve();
    }

    // ---------- Mini-check handler ----------
    function wireMiniChecks(root){
      $$(".quiz-item", root).forEach(q => {
        const answers = q.getAttribute("data-answers") || "";
        const good = new Set(answers.split("|").map(a => normalize(a.trim())).filter(Boolean));
        $$(".opt", q).forEach(opt => {
          opt.addEventListener("click", () => {
            const val = normalize(opt.getAttribute("data-val") || opt.textContent);
            const isGood = good.has(val);
            opt.classList.add("checked");
            opt.classList.toggle("good", isGood);
            opt.classList.toggle("bad", !isGood);
          });
        });
      });
    }

    // ---------- SVG helpers (using currentColor) ----------
    function svgFrame(inner){
      return `
        <div class="svg-wrap">
          <svg viewBox="0 0 720 280" width="100%" height="auto" style="display:block; max-height:240px; overflow:visible;">
            ${inner}
          </svg>
        </div>`;
    }

    // ---------- CONTENT DATA (Deep Content Complete) ----------
    const modules = [
      // Schreiben (S)
      {
        id:"S0", area:"S",
        title:"Themenpool ‚Äì von Thema zur Fragestellung",
        short:"So findest du ein diskutierbares Thema und formulierst eine klare Frage.",
        keywords:["themenpool","fragestellung","thema","standpunkt","diskutierbar","frage","er√∂rterung"],
        content(){
          const graphic = svgFrame(`
            <defs><marker id="arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="currentColor" /></marker></defs>
            <g transform="translate(60,40)">
              <path d="M0,0 L200,0 L140,100 L60,100 Z" fill="none" stroke="currentColor" stroke-width="2" opacity="0.2"/>
              <text x="100" y="40" text-anchor="middle" font-size="14" font-weight="bold">Thema (breit)</text>
              <text x="100" y="60" text-anchor="middle" font-size="11" opacity="0.6">"Handy"</text>
              <line x1="100" y1="100" x2="100" y2="140" stroke="currentColor" stroke-width="2" marker-end="url(#arrow)" opacity="0.3"/>
              <rect x="20" y="150" width="160" height="60" rx="10" fill="white" stroke="currentColor" stroke-width="2" opacity="0.3"/>
              <text x="100" y="180" text-anchor="middle" font-size="14" font-weight="bold">Fragestellung</text>
              <text x="100" y="200" text-anchor="middle" font-size="11" opacity="0.6">"Sollte man...?"</text>
            </g>
          `);

          return `
            <div class="card">
              <div class="card-head">
                <div>
                  <h2><span class="code">S0</span> ${escapeHTML(this.title)}</h2>
                  <div class="subtitle">Vom allgemeinen Schlagwort zur pr√§zisen Entscheidungsfrage.</div>
                </div>
                <div class="area-pill">‚úçÔ∏è Schreiben</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                  <div class="box">
                    <h3>Die Trichter-Methode</h3>
                    <p>Ein Thema wie "Klimaschutz" ist zu riesig. Du musst es eingrenzen, bis eine <b>Ja/Nein-Frage</b> √ºbrig bleibt.</p>
                    <div class="rule-box">Eine gute Fragestellung beginnt oft mit <b>"Sollte..."</b>, <b>"Ist es sinnvoll, dass..."</b> oder <b>"Muss..."</b>.</div>
                  </div>
                  <div class="box">
                    ${graphic}
                  </div>
                </div>
                
                <div class="box" style="margin-top:24px">
                  <h3>Beispiele: Gut vs. Schlecht</h3>
                  <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:15px">
                     <div style="background:#fef2f2; padding:10px; border-radius:8px; border:1px solid #fca5a5; font-size:13px">
                       ‚ùå "Handys in der Schule"<br>
                       <i>(Keine Frage, kein Konflikt)</i>
                     </div>
                     <div style="background:#ecfdf5; padding:10px; border-radius:8px; border:1px solid #6ee7b7; font-size:13px">
                       ‚úÖ "Sollte ein generelles Handyverbot in der Unterstufe gelten?"<br>
                       <i>(Klar, diskutierbar, Zielgruppe definiert)</i>
                     </div>
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"S1", area:"S",
        title:"Argumente trainieren ‚Äì 3B-Struktur",
        short:"So baust du √ºberzeugende Argumente in 3 Bausteinen.",
        keywords:["argument","behauptung","begruendung","beispiel","these","struktur","belegen"],
        content(){
          const graphic = svgFrame(`
            <g transform="translate(50,100)">
              <rect x="0" y="0" width="160" height="60" rx="30" fill="white" stroke="#3b82f6" stroke-width="3"/>
              <text x="80" y="35" text-anchor="middle" font-weight="bold" fill="#1e293b">1. Behauptung</text>
              <rect x="140" y="20" width="40" height="20" fill="#e2e8f0"/>
              <rect x="160" y="0" width="160" height="60" rx="30" fill="white" stroke="#3b82f6" stroke-width="3"/>
              <text x="240" y="35" text-anchor="middle" font-weight="bold" fill="#1e293b">2. Begr√ºndung</text>
              <rect x="300" y="20" width="40" height="20" fill="#e2e8f0"/>
              <rect x="320" y="0" width="160" height="60" rx="30" fill="white" stroke="#3b82f6" stroke-width="3"/>
              <text x="400" y="35" text-anchor="middle" font-weight="bold" fill="#1e293b">3. Beispiel</text>
            </g>
          `);

          return `
            <div class="card">
              <div class="card-head">
                <div>
                  <h2><span class="code">S1</span> ${escapeHTML(this.title)}</h2>
                  <div class="subtitle">Ein Argument ist wie eine Kette: Fehlt ein Glied, rei√üt sie.</div>
                </div>
                <div class="area-pill">‚úçÔ∏è Schreiben</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                  <div class="box">
                    <h3>Formulierungshilfen</h3>
                    <ul>
                      <li><b>Behauptung:</b> "Ich bin der Meinung, dass...", "Ein wichtiger Punkt ist..."</li>
                      <li><b>Begr√ºndung:</b> "...weil...", "...da...", "...denn dies f√ºhrt dazu, dass..."</li>
                      <li><b>Beispiel:</b> "Das sieht man an...", "Ein konkretes Beispiel hierf√ºr ist...", "Studien zeigen..."</li>
                    </ul>
                  </div>
                  <div class="box">
                    ${graphic}
                  </div>
                </div>

                <div class="box" style="margin-top:24px">
                  <h3>Praxis-Check: Ist das Argument vollst√§ndig?</h3>
                  <div style="background:#f1f5f9; padding:15px; border-radius:12px; margin-bottom:15px; font-style:italic; color:#334155">
                    "Schuluniformen sind gut, <b>weil</b> dann niemand mehr wegen Markenklamotten gemobbt wird."
                  </div>
                  <div class="quiz-item" data-answers="beispiel">
                    <span class="quiz-q">Welcher Teil fehlt in diesem Satz?</span>
                    <div class="quiz-opts">
                      <span class="opt" data-val="begruendung">Begr√ºndung</span>
                      <span class="opt" data-val="beispiel">Beispiel/Beleg</span>
                      <span class="opt" data-val="behauptung">Behauptung</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"S2", area:"S",
        title:"Pro/Contra abw√§gen & Urteil",
        short:"Argumente gegen√ºberstellen und ein begr√ºndetes Fazit ziehen.",
        keywords:["pro","contra","abwaegen","urteil","schluss","position","argumente"],
        content(){
          const graphic = svgFrame(`
            <g transform="translate(360,40)">
              <rect x="-150" y="20" width="300" height="6" rx="3" fill="#94a3b8"/>
              <path d="M-10,20 L10,20 L0,50 Z" fill="#64748b"/>
              <rect x="-2" y="50" width="4" height="100" fill="#64748b"/>
              <line x1="-140" y1="23" x2="-140" y2="80" stroke="#cbd5e1" stroke-width="2"/>
              <path d="M-170,80 Q-140,110 -110,80 Z" fill="#e2e8f0" stroke="#94a3b8"/>
              <text x="-140" y="75" text-anchor="middle" font-size="12" font-weight="bold">Gegenargument</text>
              <line x1="140" y1="23" x2="140" y2="110" stroke="#cbd5e1" stroke-width="2"/>
              <path d="M110,110 Q140,140 170,110 Z" fill="#3b82f6" fill-opacity="0.2" stroke="#3b82f6"/>
              <circle cx="140" cy="100" r="15" fill="#3b82f6"/>
              <text x="140" y="105" text-anchor="middle" fill="white" font-weight="bold" font-size="18">!</text>
              <text x="140" y="75" text-anchor="middle" font-size="12" font-weight="bold" fill="#1e293b">Meine Position</text>
            </g>
          `);
          return `
            <div class="card">
              <div class="card-head">
                <div>
                  <h2><span class="code">S2</span> ${escapeHTML(this.title)}</h2>
                  <div class="subtitle">Das Urteil ist keine Wiederholung, sondern eine <b>Entscheidung</b> nach dem Wiegen.</div>
                </div>
                <div class="area-pill">‚úçÔ∏è Schreiben</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                  <div class="box">
                    <h3>Die "Zwar-Aber"-Formel</h3>
                    <p>Ein starkes Urteil erkennt die Gegenseite an, entkr√§ftet sie aber.</p>
                    <div class="rule-box" style="font-family:serif; font-style:italic; font-size:16px">
                      "Zwar ist [Gegenargument] verst√§ndlich, weil...,<br> 
                      jedoch √ºberwiegt f√ºr mich [mein st√§rkstes Argument],<br>
                      da [Begr√ºndung]."
                    </div>
                  </div>
                  <div class="box">
                    ${graphic}
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"S3", area:"S",
        title:"Er√∂rterung planen ‚Äì Sanduhr-Prinzip",
        short:"Die Struktur f√ºr die dialektische Er√∂rterung.",
        keywords:["eroerterung","aufbau","einleitung","hauptteil","schluss","plan","gliederung","sanduhr"],
        content(){
           const graphic = svgFrame(`
             <g transform="translate(250,20)">
               <path d="M0,0 L220,0 L110,100 L0,0 Z" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
               <path d="M0,200 L220,200 L110,100 L0,200 Z" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
               <text x="110" y="30" text-anchor="middle" font-size="12" font-weight="bold">Gegenseite</text>
               <text x="110" y="45" text-anchor="middle" font-size="10">St√§rkstes ‚Üí Schw√§chstes</text>
               <circle cx="110" cy="100" r="15" fill="white" stroke="#3b82f6"/>
               <text x="110" y="104" text-anchor="middle" font-size="10" font-weight="bold">Wende</text>
               <text x="110" y="160" text-anchor="middle" font-size="12" font-weight="bold">Meine Seite</text>
               <text x="110" y="175" text-anchor="middle" font-size="10">Schw√§chstes ‚Üí St√§rkstes</text>
             </g>
           `);
           return `
            <div class="card">
              <div class="card-head">
                <div>
                  <h2><span class="code">S3</span> ${escapeHTML(this.title)}</h2>
                  <div class="subtitle">Das Sanduhr-Prinzip: Wie du die Argumente sortierst.</div>
                </div>
                <div class="area-pill">‚úçÔ∏è Schreiben</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                   <div class="box">
                     <h3>Der Bauplan (Dialektisch)</h3>
                     <ol>
                       <li><b>Einleitung:</b> Hinf√ºhrung (Aktuelles, Zitat) + Frage.</li>
                       <li><b>Hauptteil A (Gegenseite):</b> Beginne mit dem st√§rksten Gegenargument, ende mit dem schw√§chsten.</li>
                       <li><b>Wendepunkt:</b> "Doch nun zu den Argumenten, die f√ºr ... sprechen."</li>
                       <li><b>Hauptteil B (Meine Seite):</b> Beginne schwach, steigere dich zum <b>st√§rksten Argument</b> (das bleibt im Kopf!).</li>
                       <li><b>Schluss:</b> Fazit/Urteil.</li>
                     </ol>
                   </div>
                   <div class="box">${graphic}</div>
                </div>
              </div>
            </div>`;
        }
      },

      // Grammatik (G)
      {
        id:"G1", area:"G",
        title:"Zeitformen ‚Äì Bildung & Zeitstrahl",
        short:"Wie man die Zeiten bildet und wann man sie benutzt.",
        keywords:["zeitformen","praesens","praeteritum","perfekt","plusquamperfekt","futur"],
        content(){
          const graphic = svgFrame(`
            <g transform="translate(40,100)">
              <line x1="0" y1="0" x2="640" y2="0" stroke="#1e293b" stroke-width="2"/>
              <circle cx="50" cy="0" r="6" fill="#ef4444"/>
              <text x="50" y="-15" text-anchor="middle" font-weight="bold" font-size="12">PQP</text>
              <circle cx="180" cy="0" r="6" fill="#f59e0b"/>
              <text x="180" y="-15" text-anchor="middle" font-weight="bold" font-size="12">Pr√§teritum</text>
              <circle cx="280" cy="0" r="6" fill="#f59e0b"/>
              <text x="280" y="-35" text-anchor="middle" font-weight="bold" font-size="12">Perfekt</text>
              <line x1="380" y1="-40" x2="380" y2="40" stroke="#3b82f6" stroke-width="4"/>
              <text x="380" y="-50" text-anchor="middle" font-weight="bold" fill="#3b82f6">JETZT</text>
              <circle cx="500" cy="0" r="6" fill="#10b981"/>
              <text x="500" y="-15" text-anchor="middle" font-weight="bold" font-size="12">Futur</text>
            </g>
          `);
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G1</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="box">
                  <h3>Wie werden die Zeiten gebildet?</h3>
                  <table class="g-table">
                    <tr><th>Zeitform</th><th>Formel</th><th>Beispiel</th></tr>
                    <tr>
                      <td><b>Pr√§sens</b></td>
                      <td>Verbstamm + Endung<br><small>(-e, -st, -t, -en, -t, -en)</small></td>
                      <td>ich geh<b>e</b><br>du geh<b>st</b></td>
                    </tr>
                    <tr>
                      <td><b>Pr√§teritum</b></td>
                      <td>Stamm + <b>-te</b> (schwach)<br>oder <b>Vokalwechsel</b> (stark)</td>
                      <td>ich lern<b>te</b><br>ich <b>ging</b></td>
                    </tr>
                    <tr>
                      <td><b>Perfekt</b></td>
                      <td><span class="g-hl">haben/sein</span> + <b>Partizip II</b></td>
                      <td>ich <span class="g-hl">habe</span> gefrag<b>t</b><br>ich <span class="g-hl">bin</span> gelauf<b>en</b></td>
                    </tr>
                    <tr>
                      <td><b>Plusquamperfekt</b></td>
                      <td><span class="g-hl">hatte/war</span> + <b>Partizip II</b></td>
                      <td>ich <span class="g-hl">hatte</span> gefrag<b>t</b><br>ich <span class="g-hl">war</span> gelauf<b>en</b></td>
                    </tr>
                    <tr>
                      <td><b>Futur I</b></td>
                      <td><span class="g-hl">werden</span> + <b>Infinitiv</b></td>
                      <td>ich <span class="g-hl">werde</span> fragen</td>
                    </tr>
                  </table>
                  <div class="warn-box" style="margin-top:20px">
                    <b>Wann "sein" im Perfekt?</b><br>
                    Bei Bewegung (laufen, fahren), Zustandsver√§nderung (aufwachen, sterben) und "sein/bleiben". Sonst "haben".
                  </div>
                </div>
                <div style="margin-top:20px">${graphic}</div>
              </div>
            </div>`;
        }
      },
      {
        id:"G2", area:"G",
        title:"Verbklammer & Positionen",
        short:"Warum das Verb im Deutschen oft am Ende steht.",
        keywords:["verbformen","finite","infinite","verbklammer","praedikat"],
        content(){
          const graphic = svgFrame(`
            <g transform="translate(50,80)">
               <path d="M20,0 Q0,30 20,60" fill="none" stroke="#ef4444" stroke-width="4"/>
               <text x="30" y="35" font-weight="bold" fill="#ef4444" font-size="18">hat</text>
               <text x="30" y="55" font-size="10" fill="#ef4444">Finites Verb (Pos 2)</text>
               <text x="100" y="35" font-size="18" fill="#1e293b">der Sch√ºler die Aufgabe</text>
               <path d="M300,0 Q320,30 300,60" fill="none" stroke="#ef4444" stroke-width="4"/>
               <text x="330" y="35" font-weight="bold" fill="#ef4444" font-size="18">gel√∂st.</text>
               <text x="330" y="55" font-size="10" fill="#ef4444">Rest (Ende)</text>
               <path d="M60,70 Q180,90 310,70" fill="none" stroke="#ef4444" stroke-width="1" stroke-dasharray="5,5"/>
            </g>
          `);
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G2</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                  <div class="box">
                    <h3>Wie eine Zange</h3>
                    <p>Im Hauptsatz wird das Pr√§dikat oft zerrissen. Der erste Teil (gebeugt) steht vorne, der zweite Teil (Infinitiv/Partizip) ganz hinten.</p>
                    <ul>
                      <li>Ich <b>bin</b> heute in die Schule <b>gegangen</b>.</li>
                      <li>Sie <b>ruft</b> ihren Freund <b>an</b>.</li>
                    </ul>
                  </div>
                  <div class="box">${graphic}</div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"G3", area:"G",
        title:"Passiv Bildung",
        short:"Wie man das Passiv in allen Zeiten bildet.",
        keywords:["aktiv","passiv","werden","partizip","bildung","formen"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G3</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="box">
                  <h3>Das Passiv in den Zeiten</h3>
                  <p>Das Partizip II (z.B. <i>gesehen, gemacht</i>) bleibt immer gleich. Du ver√§nderst nur das Hilfsverb <b>werden</b>.</p>
                  
                  <table class="g-table">
                    <tr><th>Zeit</th><th>Hilfsverb "werden"</th><th>Partizip II</th><th>Beispiel</th></tr>
                    <tr>
                      <td><b>Pr√§sens</b></td>
                      <td>wird</td>
                      <td>+ gemacht</td>
                      <td>Der Test <b>wird</b> gemacht.</td>
                    </tr>
                    <tr>
                      <td><b>Pr√§teritum</b></td>
                      <td>wurde</td>
                      <td>+ gemacht</td>
                      <td>Der Test <b>wurde</b> gemacht.</td>
                    </tr>
                    <tr>
                      <td><b>Perfekt</b></td>
                      <td>ist ... worden</td>
                      <td>+ gemacht</td>
                      <td>Der Test <b>ist</b> gemacht <b>worden</b>.</td>
                    </tr>
                    <tr>
                      <td><b>Futur I</b></td>
                      <td>wird ... werden</td>
                      <td>+ gemacht</td>
                      <td>Der Test <b>wird</b> gemacht <b>werden</b>.</td>
                    </tr>
                  </table>
                  
                  <div class="warn-box" style="margin-top:20px">
                    <b>Achtung Falle!</b><br>
                    Im Passiv Perfekt hei√üt es "worden", nicht "geworden".<br>
                    ‚ùå ist gemacht <s>geworden</s><br>
                    ‚úÖ ist gemacht <b>worden</b>
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"G4", area:"G",
        title:"Konjunktiv Bildung",
        short:"Endungen f√ºr K I und die Ableitung f√ºr K II.",
        keywords:["konjunktiv","bildung","endungen","wuerde","k1","k2"],
        content(){
           return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G4</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                  <div class="box" style="border-left:4px solid #3b82f6">
                    <h3>Konjunktiv I (Der Bericht)</h3>
                    <p>Wird vom <b>Pr√§sens-Stamm</b> gebildet.</p>
                    <table class="g-table">
                      <tr><th>Person</th><th>Endung</th><th>Beispiel (gehen)</th></tr>
                      <tr><td>ich</td><td>-e</td><td>ich geh<b>e</b></td></tr>
                      <tr><td>du</td><td>-est</td><td>du geh<b>est</b></td></tr>
                      <tr><td>er/sie</td><td>-e</td><td>er geh<b>e</b></td></tr>
                      <tr><td>wir</td><td>-en</td><td>wir geh<b>en</b></td></tr>
                      <tr><td>ihr</td><td>-et</td><td>ihr geh<b>et</b></td></tr>
                      <tr><td>sie</td><td>-en</td><td>sie geh<b>en</b></td></tr>
                    </table>
                  </div>
                  <div class="box" style="border-left:4px solid #a855f7">
                    <h3>Konjunktiv II (Der Wunsch)</h3>
                    <p>Wird vom <b>Pr√§teritum-Stamm</b> gebildet (+ oft Umlaut).</p>
                    <table class="g-table">
                      <tr><th>Pr√§teritum</th><th>‚Üí</th><th>Konjunktiv II</th></tr>
                      <tr><td>er kam</td><td>‚Üí</td><td>er <b>k√§me</b></td></tr>
                      <tr><td>er war</td><td>‚Üí</td><td>er <b>w√§re</b></td></tr>
                      <tr><td>er hatte</td><td>‚Üí</td><td>er <b>h√§tte</b></td></tr>
                    </table>
                    <div class="rule-box" style="margin-top:20px">
                      <b>Die W√ºrde-Form:</b><br>
                      Wenn der K II komisch klingt (z.B. "ich f√ºhre" statt "ich w√ºrde fahren"), nutze: <br>
                      <b>w√ºrde + Infinitiv</b>.
                    </div>
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"G5", area:"G",
        title:"Verbtypen (stark/schwach)",
        short:"Stark (Vokalwechsel) vs. Schwach (-te).",
        keywords:["starke verben","schwache verben","unregelmaessige verben"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G5</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="box">
                   <h3>Die 3 Verb-Klassen</h3>
                   <table class="g-table">
                     <tr><th>Typ</th><th>Merkmal</th><th>Beispiel</th></tr>
                     <tr>
                       <td><b>Schwach</b> (Regelm√§√üig)</td>
                       <td>Kein Vokalwechsel<br>Pr√§teritum: <b>-te</b><br>Partizip II: <b>-t</b></td>
                       <td>lachen - lach<b>te</b> - gelach<b>t</b><br>kaufen - kauf<b>te</b> - gekauf<b>t</b></td>
                     </tr>
                     <tr>
                       <td><b>Stark</b></td>
                       <td><b>Vokalwechsel</b> (Ablaut)<br>Pr√§teritum: (keine Endung)<br>Partizip II: <b>-en</b></td>
                       <td>s<b>i</b>ngen - s<b>a</b>ng - ges<b>u</b>ngen<br>f<b>a</b>hren - f<b>u</b>hr - gef<b>a</b>hren</td>
                     </tr>
                     <tr>
                       <td><b>Gemischt</b></td>
                       <td>Vokalwechsel + <b>-te/-t</b> Endung</td>
                       <td>d<b>e</b>nken - d<b>a</b>ch<b>te</b> - ged<b>a</b>ch<b>t</b><br>r<b>e</b>nnen - r<b>a</b>nn<b>te</b> - ger<b>a</b>nn<b>t</b></td>
                     </tr>
                   </table>
                   <div class="rule-box" style="margin-top:15px">
                     <b>Tipp:</b> Wenn du unsicher bist, bilde das Pr√§teritum. H√∂rst du ein "-te" (spielte, machte), ist es meistens schwach.
                   </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"G6", area:"G",
        title:"Zeiten-Mix & Textsorten",
        short:"Welche Zeitform f√ºr welchen Text?",
        keywords:["zeiten mix","zeitwahl","erzaehlung","bericht","textsorten"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G6</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="box">
                  <h3>Das Gesetz der Text-Ebene</h3>
                  <p>In der Schule musst du dich meist f√ºr eine "Haupt-Zeit" entscheiden.</p>
                  
                  <table class="g-table">
                    <tr><th>Textsorte</th><th>Hauptzeit</th><th>Warum?</th></tr>
                    <tr>
                      <td><b>Erz√§hlung</b> (Aufsatz)<br>Bericht (Unfall, Zeitung)</td>
                      <td><b>Pr√§teritum</b><br><i>(kam, sah, lief)</i></td>
                      <td>Dies ist die klassische schriftliche Erz√§hlzeit.</td>
                    </tr>
                    <tr>
                      <td><b>Brief / E-Mail</b> (Privat)<br>Dialog / M√ºndlich</td>
                      <td><b>Perfekt</b><br><i>(ist gekommen, hat gesehen)</i></td>
                      <td>Wirkt n√§her, pers√∂nlicher und "wie gesprochen".</td>
                    </tr>
                    <tr>
                      <td><b>Sachtext / Inhaltsangabe</b><br>Beschreibung</td>
                      <td><b>Pr√§sens</b><br><i>(kommt, sieht, l√§uft)</i></td>
                      <td>Fakten sind zeitlos ("Der L√∂we lebt in Afrika").</td>
                    </tr>
                  </table>
                  
                  <div class="warn-box" style="margin-top:15px">
                    <b>Fehler-Alarm:</b> Springe nicht im selben Absatz zwischen Pr√§teritum und Perfekt hin und her! Bleib in deiner Spur.
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"G7", area:"G",
        title:"Stil: Aktiv vs. Passiv",
        short:"Wirkung im Text bewusst steuern.",
        keywords:["stil","wirkung","aktiv","passiv"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G7</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                   <div class="box" style="border-left:4px solid #10b981">
                     <h3>Aktiv (Der Macher)</h3>
                     <p><b>Wirkung:</b> Lebendig, dynamisch, direkt.</p>
                     <p><i>"Der Sturm zerst√∂rte das Dach."</i></p>
                     <ul style="font-size:13px">
                       <li>T√§ter ist bekannt.</li>
                       <li>Gut f√ºr Erz√§hlungen & Spannung.</li>
                     </ul>
                   </div>
                   <div class="box" style="border-left:4px solid #64748b">
                     <h3>Passiv (Der Beobachter)</h3>
                     <p><b>Wirkung:</b> Sachlich, distanziert, b√ºrokratisch.</p>
                     <p><i>"Das Dach wurde zerst√∂rt."</i></p>
                     <ul style="font-size:13px">
                       <li>T√§ter unbekannt oder egal.</li>
                       <li>Gut f√ºr Protokolle & Nachrichten.</li>
                     </ul>
                   </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"G8", area:"G",
        title:"Wortfelder & Synonyme",
        short:"Treffender schreiben statt ‚Äûmachen/tun/sagen‚Äú.",
        keywords:["synonyme","wortfeld","ausdruck"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">G8</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">üß† Grammatik</div>
              </div>
              <div class="card-body">
                <div class="box">
                   <h3>Weg mit den "schlechten" W√∂rtern</h3>
                   <p>W√∂rter wie "sagen", "machen" oder "gehen" sind langweilig. Nutze pr√§zisere Verben, die zum Kontext passen.</p>
                   
                   <table class="g-table">
                     <tr><th>Basis-Wort</th><th>Pr√§zises Synonym</th><th>Kontext (Wann?)</th></tr>
                     <tr>
                       <td><b>sagen</b></td>
                       <td>fl√ºstern<br>behaupten<br>erwidern<br>verk√ºnden</td>
                       <td>leise sprechen<br>Meinung √§u√üern<br>Antwort geben<br>offiziell sagen</td>
                     </tr>
                     <tr>
                       <td><b>machen</b></td>
                       <td>herstellen<br>erledigen<br>verursachen</td>
                       <td>produzieren<br>eine Aufgabe tun<br>Schaden/Problem ausl√∂sen</td>
                     </tr>
                     <tr>
                       <td><b>gehen</b></td>
                       <td>schlendern<br>rasen<br>humpeln</td>
                       <td>gem√ºtlich<br>sehr schnell<br>verletzt</td>
                     </tr>
                   </table>
                </div>
              </div>
            </div>`;
        }
      },

      // Rechtschreibung (R)
      {
        id:"R1", area:"R",
        title:"Fremdw√∂rter lernen",
        short:"Die 3-Spalten-Methode.",
        keywords:["fremdwoerter","lernen"],
        content(){
          const graphic = svgFrame(`
             <rect x="50" y="20" width="200" height="120" fill="white" stroke="#e2e8f0" stroke-width="2" rx="5"/>
             <line x1="50" y1="50" x2="250" y2="50" stroke="#e2e8f0"/>
             <text x="70" y="40" font-weight="bold">Karteikarte</text>
             
             <text x="70" y="70" font-family="monospace" font-size="16" fill="#3b82f6">Sympathie</text>
             <text x="70" y="90" font-size="12">Bedeutung: Zuneigung</text>
             <text x="70" y="110" font-size="11" fill="#64748b" font-style="italic">"Ich finde ihn sympathisch."</text>
             
             <circle cx="230" cy="120" r="10" fill="#10b981"/>
             <text x="226" y="124" fill="white" font-size="12">‚úî</text>
          `);
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">R1</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">‚úÖ Rechtschreibung</div>
              </div>
              <div class="card-body">
                <div class="grid-2">
                   <div class="box">
                    <h3>Die 3-Schritt-Methode</h3>
                    <p>Lerne Fremdw√∂rter niemals ohne Kontext!</p>
                    <table class="g-table">
                      <tr><th>Schritt</th><th>Aktion</th></tr>
                      <tr><td>1. Scan</td><td>Schreibe das Wort exakt ab (Achtung auf y, ph, th).</td></tr>
                      <tr><td>2. Check</td><td>Suche ein deutsches Ersatzwort (z.B. Sympathie = Zuneigung).</td></tr>
                      <tr><td>3. Satz</td><td>Bilde einen eigenen Satz. Nur so bleibt es im Kopf.</td></tr>
                    </table>
                   </div>
                   <div class="box">${graphic}</div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"R2", area:"R",
        title:"Diktat & Fehlerliste",
        short:"Fehler analysieren statt nur z√§hlen.",
        keywords:["diktat","fehlerliste"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">R2</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">‚úÖ Rechtschreibung</div>
              </div>
              <div class="card-body">
                <div class="box">
                  <h3>Wie analysiere ich Fehler?</h3>
                  <p>Ein Fehler ist nur schlimm, wenn du ihn nicht verstehst. F√ºhre eine Liste:</p>
                  <table class="g-table">
                    <tr><th>Falsch geschrieben</th><th>Richtigstellung</th><th>Grund / Strategie</th></tr>
                    <tr><td style="color:#ef4444; text-decoration:line-through">Lerer</td><td style="color:#10b981">Lehrer</td><td>Stummes h (Dehnungs-h)</td></tr>
                    <tr><td style="color:#ef4444; text-decoration:line-through">das laufen</td><td style="color:#10b981">das Laufen</td><td>Nomen-Signal (Artikel "das") -> Gro√ü</td></tr>
                    <tr><td style="color:#ef4444; text-decoration:line-through">Flus</td><td style="color:#10b981">Fluss</td><td>Kurzer Vokal -> ss (Doppelkonsonant)</td></tr>
                  </table>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"R3", area:"R",
        title:"Fremdw√∂rter im Kontext",
        short:"Passt das Wort wirklich?",
        keywords:["kontext","fremdwort"],
        content(){
          return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">R3</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">‚úÖ Rechtschreibung</div>
              </div>
              <div class="card-body">
                <div class="box">
                  <h3>Vorsicht vor "Falschen Freunden"</h3>
                  <p>Viele Fremdw√∂rter klingen √§hnlich, bedeuten aber etwas ganz anderes.</p>
                  <table class="g-table">
                    <tr><th>Wort A</th><th>Wort B</th><th>Unterschied</th></tr>
                    <tr>
                      <td><b>effektiv</b><br>(das Richtige tun)</td>
                      <td><b>effizient</b><br>(es schnell/g√ºnstig tun)</td>
                      <td>Feuer mit Wasser l√∂schen ist <i>effektiv</i>.<br>Mit wenig Wasser l√∂schen ist <i>effizient</i>.</td>
                    </tr>
                    <tr>
                      <td><b>anscheinend</b><br>(vermutlich ja)</td>
                      <td><b>scheinbar</b><br>(nur zum Schein / Illusion)</td>
                      <td>"Er schl√§ft anscheinend" (Ich glaube, er schl√§ft).<br>"Er schl√§ft scheinbar" (Er tut nur so).</td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"R4", area:"R",
        title:"Zuordnung & Strategie",
        short:"Strategien f√ºr Multiple Choice.",
        keywords:["zuordnung","bedeutung"],
        content(){
           return `
            <div class="card">
              <div class="card-head">
                <div><h2><span class="code">R4</span> ${escapeHTML(this.title)}</h2></div>
                <div class="area-pill">‚úÖ Rechtschreibung</div>
              </div>
              <div class="card-body">
                <div class="box">
                  <h3>Das Ausschluss-Verfahren</h3>
                  <p>Wenn du bei Matching-Aufgaben (Wort <-> Bedeutung) steckst:</p>
                  <ol>
                     <li>Lies <b>alle</b> Optionen erst einmal durch (links und rechts).</li>
                     <li>Verbinde zuerst die Paare, die du zu <b>100% sicher</b> wei√üt. Streiche diese durch.</li>
                     <li>Suche bei den Restlichen nach Wortst√§mmen (z.B. "Bio" = Leben, "Geo" = Erde).</li>
                     <li>Rate erst ganz zum Schluss beim allerletzten Paar, wenn n√∂tig.</li>
                  </ol>
                </div>
              </div>
            </div>`;
        }
      }
    ];

    // ---------- APP LOGIC ----------
    const modulesById = new Map(modules.map(m => [m.id, m]));
    const searchText = new Map(modules.map(m => [m.id, normalize(m.id+" "+m.title+" "+m.short+" "+(m.keywords||[]).join(" "))]));
    const state = { filter:"ALL", query:"", openId:"" };

    const elItems = $("#items");
    const elView = $("#view");
    
    function overviewHTML(){
      const counts = { S: modules.filter(m=>m.area==="S").length, G: modules.filter(m=>m.area==="G").length, R: modules.filter(m=>m.area==="R").length };
      return `
        <div class="card">
           <div class="card-head">
             <div><h2>Willkommen im Lernstudio</h2><div class="subtitle">W√§hle links ein Modul oder nutze die Suche.</div></div>
           </div>
           <div class="card-body">
             <div class="tile-grid">
               <div class="tile" onclick="setFilter('S')">
                 <div><h3>‚úçÔ∏è Schreiben</h3><p>Er√∂rterung, Argumente, Aufbau</p></div>
                 <div style="margin-top:12px; font-weight:700; color:var(--accent)">${counts.S} Module</div>
               </div>
               <div class="tile" onclick="setFilter('G')">
                 <div><h3>üß† Grammatik</h3><p>Zeitformen, Verben, Stil</p></div>
                 <div style="margin-top:12px; font-weight:700; color:var(--accent2)">${counts.G} Module</div>
               </div>
               <div class="tile" onclick="setFilter('R')">
                 <div><h3>‚úÖ Rechtschreibung</h3><p>Fremdw√∂rter, Diktat-Strategien</p></div>
                 <div style="margin-top:12px; font-weight:700; color:var(--warn)">${counts.R} Module</div>
               </div>
             </div>
           </div>
        </div>
      `;
    }

    function renderList(){
      const q = normalize(state.query);
      const filtered = modules.filter(m => (state.filter==="ALL" || m.area===state.filter) && (!q || searchText.get(m.id).includes(q)));
      
      $("#countAll").textContent = modules.length;
      $("#countNow").textContent = filtered.length;
      
      elItems.innerHTML = filtered.map(m => `
        <div class="item ${m.id===state.openId ? 'active':''}" onclick="openModule('${m.id}')">
          <div class="code">${m.id}</div>
          <div class="content">
            <div class="title">${escapeHTML(m.title)}</div>
            <div class="desc">${escapeHTML(m.short)}</div>
          </div>
        </div>
      `).join("");
    }

    function openModule(id){
      const m = modulesById.get(id);
      if(!m) return openOverview();
      state.openId = id;
      setHash(id);
      renderList(); 
      $("#crumb").innerHTML = `<span>Start</span><span>‚Ä∫</span><span>${m.area==='S'?'Schreiben':m.area==='G'?'Grammatik':'Rechtschr.'}</span><span>‚Ä∫</span><b>${m.id}</b>`;
      elView.innerHTML = typeof m.content==="function" ? m.content.call(m) : m.content;
      wireMiniChecks(elView);
      window.scrollTo(0,0);
    }

    function openOverview(){
      state.openId = "";
      setHash("");
      renderList();
      $("#crumb").innerHTML = `<span>Start</span><span>‚Ä∫</span><b>√úbersicht</b>`;
      elView.innerHTML = overviewHTML();
    }

    function setFilter(f){
      state.filter = f;
      $$(".chip").forEach(c => c.classList.toggle("active", c.getAttribute("data-filter")===f));
      renderList();
      if(!state.openId) openOverview();
    }

    $("#searchInput").addEventListener("input", e => { state.query = e.target.value; renderList(); });
    $$(".chip").forEach(c => c.addEventListener("click", ()=>setFilter(c.getAttribute("data-filter"))));
    $("#homeBtn").addEventListener("click", ()=>openOverview());
    $("#printBtn").addEventListener("click", ()=>window.print());
    $("#copyLinkBtn").addEventListener("click", ()=> { copyToClipboard(location.href); alert("Link kopiert!"); });
    window.addEventListener("hashchange", () => { const h = currentHash(); if(h && modulesById.has(h)) openModule(h); else openOverview(); });

    const h = currentHash();
    if(h && modulesById.has(h)) openModule(h); else openOverview();
    
    window.setFilter = setFilter;
    window.openModule = openModule;
  </script>
</body>
</html>
