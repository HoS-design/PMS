<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HoS Lernstudio ‚Äì Wissens-App (v0.2)</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root{
      --bg:#ffffff;
      --surface:#f8fafc;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#475569;
      --line:#e2e8f0;
      --shadow: 0 10px 30px rgba(2,6,23,.08);
      --accent:#2563eb;
      --accent2:#10b981;
      --warn:#f59e0b;
      --danger:#ef4444;
      --chip:#eef2ff;
      --chip2:#ecfeff;
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b1220;
        --surface:#0f172a;
        --card:#0b152b;
        --ink:#e5e7eb;
        --muted:#a3b2c7;
        --line:#1f2b44;
        --shadow: 0 10px 30px rgba(0,0,0,.35);
        --chip:#101c3a;
        --chip2:#0b2a2c;
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background: radial-gradient(1200px 700px at 12% 8%, rgba(37,99,235,.12), transparent 60%),
                  radial-gradient(1000px 600px at 90% 10%, rgba(16,185,129,.10), transparent 60%),
                  var(--bg);
    }
    a{color:inherit}
    .app{
      display:grid;
      grid-template-columns: 340px 1fr;
      min-height:100vh;
    }
    @media (max-width: 980px){
      .app{grid-template-columns: 1fr}
      .sidebar{position:sticky; top:0; z-index:5}
    }

    /* Sidebar */
    .sidebar{
      border-right:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,.35));
    }
    @media (prefers-color-scheme: dark){
      .sidebar{
        background: linear-gradient(180deg, rgba(11,18,32,.75), rgba(11,18,32,.55));
      }
    }
    .side-inner{padding:18px 16px 16px; position:sticky; top:0}
    .brand{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 14px;
      background: rgba(255,255,255,.6);
      border:1px solid var(--line);
      border-radius: calc(var(--radius) + 6px);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    @media (prefers-color-scheme: dark){
      .brand{background: rgba(11,18,32,.6)}
    }
    .brand h1{margin:0; font-size:16px; letter-spacing:.2px}
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      font-weight:800;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      background: rgba(37,99,235,.12);
      border:1px solid rgba(37,99,235,.25);
      color: var(--ink);
      white-space:nowrap;
    }
    .badge b{color:var(--accent)}
    .sub{margin:8px 0 0; font-size:12px; color:var(--muted)}
    .search{
      margin-top:14px;
      padding:12px;
      background: rgba(255,255,255,.55);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: 0 8px 22px rgba(2,6,23,.05);
      backdrop-filter: blur(10px);
    }
    @media (prefers-color-scheme: dark){
      .search{background: rgba(11,18,32,.55); box-shadow: 0 8px 22px rgba(0,0,0,.25)}
    }
    .search label{display:flex; align-items:center; gap:10px}
    .search input{
      width:100%;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: var(--card);
      color: var(--ink);
      outline:none;
      font-size:14px;
    }
    .search input:focus{border-color: rgba(37,99,235,.55); box-shadow: 0 0 0 4px rgba(37,99,235,.15)}
    .hint{margin:10px 2px 0; font-size:12px; color:var(--muted); line-height:1.35}
    .filters{
      margin-top:12px;
      display:flex; flex-wrap:wrap; gap:8px;
    }
    .chip{
      border:1px solid var(--line);
      background: var(--chip);
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      cursor:pointer;
      user-select:none;
    }
    .chip.active{border-color: rgba(37,99,235,.45); color: var(--ink); background: rgba(37,99,235,.12)}
    .list{
      margin-top:14px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.55);
      overflow:hidden;
      box-shadow: 0 10px 30px rgba(2,6,23,.05);
      backdrop-filter: blur(10px);
    }
    @media (prefers-color-scheme: dark){
      .list{background: rgba(11,18,32,.55); box-shadow: 0 10px 30px rgba(0,0,0,.28)}
    }
    .list-head{
      padding:12px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-bottom:1px solid var(--line);
    }
    .list-head .title{font-weight:900; font-size:13px}
    .count{font-family:var(--mono); font-size:12px; color:var(--muted)}
    .items{max-height: calc(100vh - 270px); overflow:auto}
    @media (max-width: 980px){
      .items{max-height: 48vh}
    }
    .item{
      display:flex; gap:12px; align-items:flex-start;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      cursor:pointer;
    }
    .item:last-child{border-bottom:none}
    .item:hover{background: rgba(37,99,235,.06)}
    .code{
      font-family: var(--mono);
      font-weight:900;
      font-size:12px;
      padding:6px 9px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.7);
      white-space:nowrap;
      min-width:50px;
      text-align:center;
    }
    @media (prefers-color-scheme: dark){
      .code{background: rgba(15,23,42,.7)}
    }
    .meta{flex:1}
    .meta .t{font-weight:900; font-size:13px; margin:0}
    .meta .d{margin:4px 0 0; font-size:12px; color:var(--muted); line-height:1.25}
    .tagrow{margin-top:7px; display:flex; flex-wrap:wrap; gap:6px}
    .tag{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.6);
      color:var(--muted);
    }
    @media (prefers-color-scheme: dark){
      .tag{background: rgba(11,18,32,.6)}
    }

    /* Main */
    .main{padding:22px 26px 42px}
    @media (max-width: 980px){ .main{padding:18px 14px 28px}}
    .topbar{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      margin-bottom:14px;
    }
    .crumb{
      display:flex; align-items:center; gap:8px; flex-wrap:wrap;
      color: var(--muted);
      font-size:12px;
    }
    .crumb b{color:var(--ink)}
    .btns{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end}
    .btn{
      border:1px solid var(--line);
      background: rgba(255,255,255,.55);
      color: var(--ink);
      border-radius: 14px;
      padding:10px 12px;
      font-size:13px;
      font-weight:900;
      cursor:pointer;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 22px rgba(2,6,23,.05);
    }
    @media (prefers-color-scheme: dark){ .btn{background: rgba(11,18,32,.55); box-shadow: 0 8px 22px rgba(0,0,0,.28)}}
    .btn:hover{transform: translateY(-1px)}
    .btn:active{transform: translateY(0px)}
    .btn.primary{
      border-color: rgba(37,99,235,.45);
      background: rgba(37,99,235,.12);
    }
    .card{
      background: rgba(255,255,255,.62);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    @media (prefers-color-scheme: dark){ .card{background: rgba(11,18,32,.62)}}
    .card .hd{
      padding:16px 18px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
    }
    .card .hd h2{margin:0; font-size:18px; letter-spacing:.2px}
    .card .hd .small{margin:6px 0 0; font-size:12px; color:var(--muted); line-height:1.35}
    .card .bd{padding:16px 18px}
    .cols{
      display:grid;
      grid-template-columns: 1.35fr 1fr;
      gap:14px;
    }
    @media (max-width: 980px){ .cols{grid-template-columns: 1fr} }
    .box{
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.55);
      padding:14px 14px;
    }
    @media (prefers-color-scheme: dark){ .box{background: rgba(15,23,42,.5)}}
    .box h3{margin:0 0 8px; font-size:13px}
    .box p, .box li{color:var(--muted); font-size:13px; line-height:1.5}
    .box ul{margin:8px 0 0 18px; padding:0}
    .kpi{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.6);
      font-size:12px;
      color:var(--muted);
    }
    @media (prefers-color-scheme: dark){ .pill{background: rgba(11,18,32,.6)}}
    .pill b{color:var(--ink)}
    .rule{
      border-left:4px solid rgba(37,99,235,.55);
      background: rgba(37,99,235,.08);
      padding:12px 12px;
      border-radius: 14px;
      margin: 0;
      color: var(--ink);
      font-size:13px;
      line-height:1.5;
    }
    .warn{
      border-left:4px solid rgba(245,158,11,.75);
      background: rgba(245,158,11,.10);
      padding:12px 12px;
      border-radius: 14px;
      margin: 0;
      font-size:13px;
      line-height:1.5;
      color: var(--ink);
    }
    .mini{display:flex; flex-direction:column; gap:10px; margin-top:10px}
    .q{
      border:1px dashed rgba(148,163,184,.7);
      border-radius: 14px;
      padding:12px 12px;
      background: rgba(255,255,255,.45);
    }
    @media (prefers-color-scheme: dark){ .q{background: rgba(2,6,23,.15)}}
    .q .qt{font-weight:900; font-size:13px; margin:0 0 6px}
    .q .qa{display:flex; flex-wrap:wrap; gap:8px}
    .opt{
      border:1px solid var(--line);
      background: rgba(255,255,255,.6);
      border-radius: 999px;
      padding:7px 10px;
      font-size:12px;
      color: var(--muted);
      cursor:pointer;
      user-select:none;
    }
    @media (prefers-color-scheme: dark){ .opt{background: rgba(11,18,32,.6)}}
    .opt.good{border-color: rgba(16,185,129,.45)}
    .opt.bad{border-color: rgba(239,68,68,.45)}
    .opt.on.good{background: rgba(16,185,129,.12); color: var(--ink)}
    .opt.on.bad{background: rgba(239,68,68,.10); color: var(--ink)}
    .opt:focus{outline:none; box-shadow: 0 0 0 4px rgba(37,99,235,.15)}
    .svgwrap{border:1px solid var(--line); border-radius: 16px; padding:10px; background: rgba(255,255,255,.55); overflow:hidden}
    @media (prefers-color-scheme: dark){ .svgwrap{background: rgba(15,23,42,.5)}}
    .footer-note{margin-top:12px; color:var(--muted); font-size:12px; line-height:1.35}
    .homegrid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:14px;
    }
    .tile{
      grid-column: span 4;
      border:1px solid var(--line);
      background: rgba(255,255,255,.62);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px 14px;
      cursor:pointer;
      position:relative;
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    @media (prefers-color-scheme: dark){ .tile{background: rgba(11,18,32,.62)}}
    @media (max-width: 980px){ .tile{grid-column: span 6}}
    @media (max-width: 560px){ .tile{grid-column: span 12}}
    .tile:hover{transform: translateY(-2px)}
    .tile .top{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .tile h3{margin:10px 0 0; font-size:14px}
    .tile p{margin:6px 0 0; font-size:12px; color:var(--muted); line-height:1.35}
    .tile .bg{
      position:absolute; inset:auto -30px -30px auto;
      width:140px; height:140px; border-radius: 40px;
      background: radial-gradient(circle at 30% 30%, rgba(37,99,235,.35), transparent 60%),
                  radial-gradient(circle at 60% 70%, rgba(16,185,129,.25), transparent 60%);
      transform: rotate(18deg);
      opacity:.9;
      pointer-events:none;
    }

    @media print{
      .sidebar, .btns{display:none !important}
      .app{grid-template-columns:1fr}
      .main{padding:0}
      body{background:#fff}
      .card, .tile, .brand, .search, .list{box-shadow:none; backdrop-filter:none; background:#fff}
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="side-inner">
        <div class="brand">
          <div>
            <div class="badge">üìö HoS <b>Lernstudio</b> ‚Ä¢ Wissens-App</div>
            <h1 style="margin-top:8px">Plan-Module (ohne Lesen)</h1>
            <p class="sub">Erkl√§rungen + Grafiken + Mini-Checks </p>
          </div>
        </div>

        <div class="search" role="search">
          <label aria-label="Suche">
            <span style="font-size:18px">üîé</span>
            <input id="searchInput" type="search" placeholder="Suche: G3, Passiv, Konjunktiv, Fremdw√∂rter ‚Ä¶" autocomplete="off" />
          </label>
          <div class="filters" aria-label="Filter">
            <span class="chip active" data-filter="ALL">Alle</span>
            <span class="chip" data-filter="S">Schreiben</span>
            <span class="chip" data-filter="G">Grammatik/Wortschatz</span>
            <span class="chip" data-filter="R">Rechtschreibung</span>
          </div>
          <p class="hint">Tipp: Suche auch nach <b>Station-Codes</b> (z.B. <span style="font-family:var(--mono)">G3</span>) oder Begriffen wie ‚ÄûZeitformen‚Äú, ‚ÄûSynonyme‚Äú.</p>
        </div>

        <div class="list" aria-label="Modulliste">
          <div class="list-head">
            <div class="title">Module</div>
            <div class="count"><span id="countNow">0</span>/<span id="countAll">0</span></div>
          </div>
          <div id="items" class="items"></div>
        </div>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="crumb" id="crumb">
          <span>Start</span>
          <span>‚Ä∫</span>
          <b>√úbersicht</b>
        </div>
        <div class="btns">
          <button class="btn" id="homeBtn" title="Zur √úbersicht">üè† √úbersicht</button>
          <button class="btn" id="printBtn" title="Drucken / als PDF speichern">üñ®Ô∏è Drucken</button>
          <button class="btn primary" id="copyLinkBtn" title="Link (Hash) kopieren">üîó Link</button>
        </div>
      </div>

      <div id="view"></div>

      <p class="footer-note">
        HoS
      </p>
    </main>
  </div>

  <script>
    // ---------- Utilities ----------
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
    const escapeHTML = (s) => (s||"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
    function normalize(s){
      return (s||"").toString().toLowerCase()
        .replace(/√§/g,"ae").replace(/√∂/g,"oe").replace(/√º/g,"ue").replace(/√ü/g,"ss");
    }
    function setHash(id){
      history.replaceState(null, "", id ? ("#"+id) : "#");
    }
    function currentHash(){
      const h = (location.hash||"").replace("#","").trim();
      return h || "";
    }
    function copyToClipboard(text){
      if(navigator.clipboard?.writeText) return navigator.clipboard.writeText(text);
      const ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand("copy");
      ta.remove();
      return Promise.resolve();
    }

    // ---------- Mini-check handler ----------
    function wireMiniChecks(root){
      $$(".q", root).forEach(q => {
        const answers = q.getAttribute("data-answers") || "";
        const good = new Set(answers.split("|").map(a => normalize(a.trim())).filter(Boolean));
        $$(".opt", q).forEach(opt => {
          opt.setAttribute("tabindex","0");
          opt.addEventListener("click", () => {
            const val = normalize(opt.getAttribute("data-val") || opt.textContent);
            const isGood = good.has(val);
            opt.classList.add("on");
            opt.classList.toggle("good", isGood);
            opt.classList.toggle("bad", !isGood);
          });
          opt.addEventListener("keydown", (e) => {
            if(e.key === "Enter" || e.key === " "){
              e.preventDefault();
              opt.click();
            }
          });
        });
      });
    }

    // ---------- SVG helpers ----------
    function svgFrame(inner){
      return `
        <div class="svgwrap" aria-label="Grafik">
          <svg viewBox="0 0 720 260" width="100%" height="auto" role="img" aria-label="Schema">
            <defs>
              <linearGradient id="g1" x1="0" x2="1">
                <stop offset="0" stop-color="currentColor" stop-opacity="0.10"></stop>
                <stop offset="1" stop-color="currentColor" stop-opacity="0.02"></stop>
              </linearGradient>
            </defs>
            <rect x="10" y="10" width="700" height="240" rx="22" fill="url(#g1)" stroke="currentColor" stroke-opacity="0.18"></rect>
            ${inner}
          </svg>
        </div>`;
    }

    // ---------- Module data ----------
    const modules = [
      // Schreiben (S)
      {
        id:"S0", area:"S",
        title:"Themenpool ‚Äì von Thema zur Fragestellung",
        short:"So findest du ein diskutierbares Thema und formulierst eine klare Frage.",
        keywords:["themenpool","fragestellung","thema","standpunkt","diskutierbar","frage","er√∂rterung"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Thema ‚Üí Fragestellung ‚Üí Standpunkt</text>
            <path d="M70 78 L250 78" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
            <g>
              <rect x="46" y="94" width="190" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="68" y="126" font-size="16" fill="currentColor" opacity="0.9" font-weight="800">Thema</text>
              <text x="68" y="145" font-size="12" fill="currentColor" opacity="0.7">z.B. ‚ÄûHandy in der Schule‚Äú</text>
            </g>
            <g opacity="0.85">
              <path d="M250 120 L314 120" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="314,120 300,112 300,128" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="324" y="94" width="190" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="346" y="126" font-size="16" fill="currentColor" opacity="0.9" font-weight="800">Fragestellung</text>
              <text x="346" y="145" font-size="12" fill="currentColor" opacity="0.7">‚ÄûSoll ‚Ä¶?‚Äú, ‚ÄûInwiefern ‚Ä¶?‚Äú</text>
            </g>
            <g opacity="0.85">
              <path d="M528 120 L592 120" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="592,120 578,112 578,128" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="602" y="94" width="92" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="622" y="126" font-size="16" fill="currentColor" opacity="0.9" font-weight="800">Ich</text>
              <text x="616" y="145" font-size="12" fill="currentColor" opacity="0.7">Urteil</text>
            </g>
            <text x="38" y="204" font-size="13" fill="currentColor" opacity="0.7">Check: Ist das Thema diskutierbar? (Pro & Contra)</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">S0</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Thema ausw√§hlen, <b>Fragestellung</b> formulieren, ersten Standpunkt vorbereiten.</div>
                </div>
                <div class="pill"><span>‚úçÔ∏è</span> <b>Schreiben</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Worum geht‚Äôs?</h3>
                    <p>Ein Thema ist erst dann ‚Äûer√∂rterbar‚Äú, wenn man wirklich <b>abw√§gen</b> kann. Das klappt am besten, wenn du aus dem Thema eine <b>Frage</b> machst.</p>
                    <p class="rule"><b>Merksatz:</b> Thema ‚â† Fragestellung. Erst die Frage macht klar, <b>wor√ºber</b> du diskutierst.</p>
                    <div class="kpi">
                      <span class="pill">üîç <b>diskutierbar</b> = Pro & Contra</span>
                      <span class="pill">üéØ <b>klar</b> = eine Frage</span>
                      <span class="pill">üß≠ <b>Urteil</b> = Abw√§gen</span>
                    </div>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Denke an einen Trichter: breit starten, dann pr√§zisieren.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Beispiele</h3>
                  <ul>
                    <li><b>Thema:</b> ‚ÄûSoziale Medien‚Äú</li>
                    <li><b>Fragestellung:</b> ‚ÄûSollten Jugendliche t√§glich maximal 2 Stunden Social Media nutzen?‚Äú</li>
                    <li><b>Noch besser:</b> ‚ÄûSollte die Schule eine Obergrenze empfehlen ‚Äì oder ist das Privatsache?‚Äú</li>
                  </ul>
                  <p class="warn"><b>Typischer Fehler:</b> Zu allgemein (‚ÄûIst Social Media gut?‚Äú). <br><b>Fix:</b> Konkreter (Wer? Wo? Wie viel? Unter welchen Bedingungen?).</p>

                  <div class="mini">
                    <div class="q" data-answers="nein">
                      <p class="qt">Mini-Check: ‚ÄûIst das diskutierbar?‚Äú ‚Äì ‚ÄûIn √ñsterreich gibt es Schulpflicht.‚Äú</p>
                      <div class="qa">
                        <span class="opt" data-val="ja">Ja</span>
                        <span class="opt" data-val="nein">Nein</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"S1", area:"S",
        title:"Argumente trainieren ‚Äì Behauptung, Begr√ºndung, Beispiel",
        short:"So baust du √ºberzeugende Argumente in 3 Bausteinen.",
        keywords:["argument","behauptung","begruendung","beispiel","these","struktur","belegen"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">3-Baustein-Argument</text>
            <g>
              <rect x="44" y="88" width="200" height="64" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="68" y="120" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Behauptung</text>
              <text x="68" y="142" font-size="12" fill="currentColor" opacity="0.7">Was meinst du?</text>
            </g>
            <g opacity="0.85">
              <path d="M252 120 L318 120" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="318,120 304,112 304,128" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="328" y="88" width="200" height="64" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="352" y="120" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Begr√ºndung</text>
              <text x="352" y="142" font-size="12" fill="currentColor" opacity="0.7">Warum stimmt das?</text>
            </g>
            <g opacity="0.85">
              <path d="M536 120 L602 120" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="602,120 588,112 588,128" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="612" y="88" width="64" height="64" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="626" y="120" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Bsp.</text>
              <text x="620" y="142" font-size="11" fill="currentColor" opacity="0.7">Beleg</text>
            </g>
            <text x="38" y="204" font-size="13" fill="currentColor" opacity="0.7">Check: Ohne Beispiel bleibt es oft nur eine Meinung.</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">S1</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Argumente so bauen, dass sie <b>logisch</b> und <b>belegt</b> sind.</div>
                </div>
                <div class="pill"><span>üß©</span> <b>Schreiben</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Merksatz</h3>
                    <p class="rule"><b>Merksatz:</b> Ein starkes Argument hat 3 Teile: <b>Behauptung</b> (Was?), <b>Begr√ºndung</b> (Warum?), <b>Beispiel/Beleg</b> (Woran sieht man das?).</p>
                    <ul>
                      <li><b>Behauptung:</b> klare Aussage.</li>
                      <li><b>Begr√ºndung:</b> logischer Grund (weil ‚Ä¶).</li>
                      <li><b>Beispiel:</b> konkrete Situation, Zahl, Erfahrung.</li>
                    </ul>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Wenn du nur ‚ÄûIch finde ‚Ä¶‚Äú schreibst, fehlt meist Begr√ºndung/Beleg.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="beispiel">
                      <p class="qt">Was fehlt?</p>
                      <p style="margin:0;color:var(--muted);font-size:13px;line-height:1.5">‚ÄûIn der Schule sollte es mehr Sport geben, weil das gesund ist.‚Äú</p>
                      <div class="qa" style="margin-top:10px">
                        <span class="opt" data-val="begruendung">Begr√ºndung</span>
                        <span class="opt" data-val="beispiel">Beispiel/Beleg</span>
                        <span class="opt" data-val="behauptung">Behauptung</span>
                      </div>
                    </div>
                  </div>
                  <p class="footer-note">Hier gibt‚Äôs keine Punkte: nur ‚Äûverstanden‚Äú vs. ‚Äûnochmal ansehen‚Äú.</p>
                </div>
              </div>
            </div>`;
        }
      },
	  {
        id:"S2", area:"S",
        title:"Pro/Contra sammeln & ein Urteil formulieren",
        short:"So w√§gt man Argumente ab und schreibt ein klares Schluss-Urteil.",
        keywords:["pro","contra","abwaegen","urteil","schluss","position","argumente"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Abw√§gen ‚Üí Urteil</text>
            <g>
              <path d="M150 95 L150 190" stroke="currentColor" stroke-opacity="0.22" stroke-width="6" stroke-linecap="round"/>
              <path d="M150 125 L95 170" stroke="currentColor" stroke-opacity="0.22" stroke-width="6" stroke-linecap="round"/>
              <path d="M150 125 L205 170" stroke="currentColor" stroke-opacity="0.22" stroke-width="6" stroke-linecap="round"/>
              <rect x="60" y="170" width="70" height="30" rx="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <rect x="170" y="170" width="70" height="30" rx="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="79" y="190" font-size="12" fill="currentColor" opacity="0.75">PRO</text>
              <text x="188" y="190" font-size="12" fill="currentColor" opacity="0.75">CONTRA</text>
            </g>
            <g opacity="0.85">
              <path d="M270 150 L370 150" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="370,150 356,142 356,158" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="386" y="112" width="300" height="78" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="410" y="145" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Urteil</text>
              <text x="410" y="168" font-size="12" fill="currentColor" opacity="0.7">‚ÄûInsgesamt √ºberwiegt ‚Ä¶, weil ‚Ä¶‚Äú</text>
            </g>
            <text x="38" y="230" font-size="13" fill="currentColor" opacity="0.7">Check: Nenne 1 Gegenargument ‚Äì und entkr√§fte es fair.</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">S2</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Pro/Contra sammeln und ein Urteil schreiben, das zeigt: <b>Du hast abgewogen</b>.</div>
                </div>
                <div class="pill"><span>‚öñÔ∏è</span> <b>Schreiben</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Merksatz</h3>
                    <p class="rule"><b>Urteil = Abw√§gen + Begr√ºnden.</b> Du entscheidest dich und sagst <b>warum</b> (mit 1 Beispiel).</p>
                    <ul>
                      <li>Mindestens <b>ein</b> Gegenargument erw√§hnen.</li>
                      <li>Fair bleiben (nicht l√§cherlich machen).</li>
                      <li>‚ÄûZwar ‚Ä¶, aber ‚Ä¶‚Äú ist eine super Entkr√§ftung.</li>
                    </ul>
                    <p class="warn"><b>Typischer Fehler:</b> Urteil ohne Begr√ºndung. <br><b>Fix:</b> ‚ÄûInsgesamt √ºberwiegt ‚Ä¶, weil ‚Ä¶ (Begr√ºndung + Beispiel).‚Äú</p>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Das Urteil ist nicht nur ‚ÄûJa/Nein‚Äú, sondern eine kurze Begr√ºndung.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="zwar stimmt|insgesamt ueberwiegt">
                      <p class="qt">Welche Formulierungen zeigen Abw√§gen?</p>
                      <div class="qa">
                        <span class="opt" data-val="ich finde">‚ÄûIch finde ‚Ä¶‚Äú</span>
                        <span class="opt" data-val="zwar stimmt">‚ÄûZwar stimmt ‚Ä¶, aber ‚Ä¶‚Äú</span>
                        <span class="opt" data-val="insgesamt ueberwiegt">‚ÄûInsgesamt √ºberwiegt ‚Ä¶, weil ‚Ä¶‚Äú</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"S3", area:"S",
        title:"Er√∂rterung planen ‚Äì Aufbau & Reihenfolge",
        short:"Einleitung‚ÄìHauptteil‚ÄìSchluss: so entsteht ein klarer Plan.",
        keywords:["eroerterung","aufbau","einleitung","hauptteil","schluss","plan","gliederung"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Aufbau-Map</text>
            <g>
              <rect x="46" y="86" width="210" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="68" y="118" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Einleitung</text>
              <text x="68" y="138" font-size="12" fill="currentColor" opacity="0.7">Thema + Frage + Kontext</text>
            </g>
            <g opacity="0.85">
              <path d="M272 112 L328 112" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="328,112 314,104 314,120" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="338" y="70" width="330" height="110" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="362" y="98" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Hauptteil</text>
              <text x="362" y="120" font-size="12" fill="currentColor" opacity="0.7">Pro/Contra in sinnvoller Reihenfolge</text>
              <text x="362" y="145" font-size="12" fill="currentColor" opacity="0.7">Argumente als 3-Baustein-Kette</text>
              <text x="362" y="170" font-size="12" fill="currentColor" opacity="0.7">√úberg√§nge (‚ÄûAu√üerdem‚Ä¶‚Äú, ‚ÄûJedoch‚Ä¶‚Äú)</text>
            </g>
            <g opacity="0.85">
              <path d="M272 210 L328 210" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="328,210 314,202 314,218" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="46" y="184" width="210" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="68" y="216" font-size="16" fill="currentColor" opacity="0.9" font-weight="900">Schluss</text>
              <text x="68" y="236" font-size="12" fill="currentColor" opacity="0.7">Urteil + Ausblick</text>
            </g>
            <text x="362" y="214" font-size="13" fill="currentColor" opacity="0.7">Tipp: st√§rkstes Argument zuletzt (bleibt im Kopf).</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">S3</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du planst den Text, bevor du schreibst ‚Äì so wird‚Äôs klarer und schneller.</div>
                </div>
                <div class="pill"><span>üó∫Ô∏è</span> <b>Schreiben</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Plan in 6 Schritten</h3>
                    <ul>
                      <li>Fragestellung notieren.</li>
                      <li>Pro/Contra sammeln (Stichw√∂rter).</li>
                      <li>Argumente zu 3-Baustein-Ketten ausbauen.</li>
                      <li>Reihenfolge festlegen (stark ‚Üí st√§rker).</li>
                      <li>Einleitung & Schluss skizzieren.</li>
                      <li>√úberg√§nge notieren.</li>
                    </ul>
                    <p class="rule"><b>Merksatz:</b> Ein guter Text entsteht zuerst im Plan ‚Äì nicht im Drauflosschreiben.</p>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="einleitung">
                      <p class="qt">Wo geh√∂rt das hin?</p>
                      <p style="margin:0;color:var(--muted);font-size:13px;line-height:1.5">‚ÄûIn den letzten Jahren nutzen immer mehr Jugendliche Smartphones im Unterricht.‚Äú</p>
                      <div class="qa" style="margin-top:10px">
                        <span class="opt" data-val="einleitung">Einleitung</span>
                        <span class="opt" data-val="hauptteil">Hauptteil</span>
                        <span class="opt" data-val="schluss">Schluss</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },

      // Grammatik/Wortschatz (G)
      {
        id:"G1", area:"G",
        title:"Zeitformen ‚Äì √úberblick & Bildung",
        short:"Pr√§sens, Pr√§teritum, Perfekt, Plusquamperfekt, Futur I/II ‚Äì mit Bildungsschema.",
        keywords:["zeitformen","praesens","praeteritum","perfekt","plusquamperfekt","futur","partizip","hilfsverb"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Zeitstrahl (grob)</text>
            <path d="M70 150 L650 150" stroke="currentColor" stroke-opacity="0.22" stroke-width="6" stroke-linecap="round"/>
            <circle cx="160" cy="150" r="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="3"/>
            <text x="130" y="182" font-size="12" fill="currentColor" opacity="0.75">Vergangenheit</text>
            <circle cx="360" cy="150" r="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="3"/>
            <text x="338" y="182" font-size="12" fill="currentColor" opacity="0.75">Gegenwart</text>
            <circle cx="560" cy="150" r="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="3"/>
            <text x="542" y="182" font-size="12" fill="currentColor" opacity="0.75">Zukunft</text>
            <text x="38" y="222" font-size="12" fill="currentColor" opacity="0.65">Tipp: Zeitformen zeigen oft auch Stil (erz√§hlen / berichten / planen).</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G1</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Zeitformen erkennen & bilden (inkl. Hilfsverben und Partizip II).</div>
                </div>
                <div class="pill"><span>‚è≥</span> <b>Grammatik</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>√úberblick</h3>
                    <ul>
                      <li><b>Pr√§sens:</b> ich gehe</li>
                      <li><b>Pr√§teritum:</b> ich ging</li>
                      <li><b>Perfekt:</b> ich <b>habe/bin</b> gegangen</li>
                      <li><b>Plusquamperfekt:</b> ich <b>hatte/war</b> gegangen</li>
                      <li><b>Futur I:</b> ich <b>werde</b> gehen</li>
                      <li><b>Futur II:</b> ich <b>werde</b> gegangen <b>sein/haben</b></li>
                    </ul>
                    <p class="rule"><b>Merksatz:</b> Perfekt/Plusquamperfekt/Futur II brauchen <b>Partizip II</b> + <b>Hilfsverb</b>.</p>
                    <p class="warn"><b>Typischer Fehler:</b> falsches Hilfsverb (haben/sein). <br><b>Fix:</b> Bewegung/Zustandswechsel oft <b>sein</b> (‚Äûgehen‚Äú, ‚Äûfahren‚Äú, ‚Äûsterben‚Äú).</p>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Pr√§teritum: oft Erz√§hlzeit. Perfekt: oft Gespr√§ch/Alltag.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="perfekt">
                      <p class="qt">‚ÄûIch habe gegessen.‚Äú ‚Äì Welche Zeitform?</p>
                      <div class="qa">
                        <span class="opt" data-val="praesens">Pr√§sens</span>
                        <span class="opt" data-val="perfekt">Perfekt</span>
                        <span class="opt" data-val="futur">Futur</span>
                      </div>
                    </div>
                    <div class="q" data-answers="futur ii">
                      <p class="qt">‚ÄûMorgen werde ich die Aufgabe erledigt haben.‚Äú ‚Äì Welche Zeitform?</p>
                      <div class="qa">
                        <span class="opt" data-val="futur i">Futur I</span>
                        <span class="opt" data-val="futur ii">Futur II</span>
                        <span class="opt" data-val="plusquamperfekt">Plusquamperfekt</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"G2", area:"G",
        title:"Verbformen & Verbklammer ‚Äì Finite vs. Infinite Teile",
        short:"So findest du das finite Verb (Person/Zeit) und erkennst die Verbklammer.",
        keywords:["verbformen","finite","infinite","verbklammer","praedikat","satzklammer","partizip","infinitiv"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Verbklammer</text>
            <text x="40" y="108" font-size="13" fill="currentColor" opacity="0.7">‚ÄûIch</text>
            <rect x="74" y="92" width="92" height="24" rx="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
            <text x="86" y="108" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">habe</text>
            <text x="175" y="108" font-size="13" fill="currentColor" opacity="0.7">gestern in Graz</text>
            <rect x="310" y="92" width="108" height="24" rx="10" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
            <text x="322" y="108" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">gegessen</text>
            <text x="430" y="108" font-size="13" fill="currentColor" opacity="0.7">.‚Äú</text>
            <text x="40" y="154" font-size="12" fill="currentColor" opacity="0.65">links: finites Verb (Person/Zeit) ‚Ä¢ rechts: infinites Verbteil (Infinitiv/Partizip)</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G2</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Finite Verbform finden und Verbklammer verstehen.</div>
                </div>
                <div class="pill"><span>üß†</span> <b>Grammatik</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Regeln</h3>
                    <p class="rule"><b>Finit</b> = ver√§ndert sich nach <b>Person</b> und <b>Zeit</b>. <b>Infinit</b> = bleibt gleich (Infinitiv/Partizip).</p>
                    <ul>
                      <li>In Haupts√§tzen steht das <b>finite Verb</b> oft an Position 2.</li>
                      <li>Weitere Verbteile stehen h√§ufig am Satzende (Verbklammer).</li>
                      <li>Hilfsverben: <b>haben/sein/werden</b>.</li>
                    </ul>
                    <p class="warn"><b>Typischer Fehler:</b> Nur ein Verbteil markieren. <br><b>Fix:</b> Suche nach Hilfsverb + Infinitiv/Partizip.</p>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Die Verbklammer ‚Äûh√§lt‚Äú den Satz zusammen.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="werde">
                      <p class="qt">Welches Wort ist das finite Verb?</p>
                      <p style="margin:0;color:var(--muted);font-size:13px;line-height:1.5">‚ÄûIch <b>werde</b> morgen l√§nger lernen.‚Äú</p>
                      <div class="qa" style="margin-top:10px">
                        <span class="opt" data-val="werde">werde</span>
                        <span class="opt" data-val="lernen">lernen</span>
                        <span class="opt" data-val="morgen">morgen</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"G3", area:"G",
        title:"Aktiv ‚Üî Passiv ‚Äì Bildung & Wirkung",
        short:"werden + Partizip II (+ von) ‚Äì und wann Passiv sinnvoll ist.",
        keywords:["aktiv","passiv","werden","partizip ii","von","taeter","handlung","objektiv"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Aktiv vs. Passiv</text>
            <g>
              <rect x="44" y="86" width="300" height="70" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="66" y="112" font-size="14" fill="currentColor" opacity="0.85" font-weight="900">Aktiv</text>
              <text x="66" y="134" font-size="12" fill="currentColor" opacity="0.7">T√§ter im Fokus</text>
              <text x="180" y="134" font-size="12" fill="currentColor" opacity="0.7">‚ÄûDer Hund bei√üt den Mann.‚Äú</text>
            </g>
            <g opacity="0.85">
              <path d="M360 121 L420 121" stroke="currentColor" stroke-opacity="0.35" stroke-width="3"/>
              <polygon points="420,121 406,113 406,129" fill="currentColor" opacity="0.35"/>
            </g>
            <g>
              <rect x="430" y="86" width="250" height="70" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="452" y="112" font-size="14" fill="currentColor" opacity="0.85" font-weight="900">Passiv</text>
              <text x="452" y="134" font-size="12" fill="currentColor" opacity="0.7">Handlung/Objekt</text>
              <text x="582" y="134" font-size="12" fill="currentColor" opacity="0.7">‚ÄûDer Mann wird gebissen.‚Äú</text>
            </g>
            <text x="38" y="198" font-size="12" fill="currentColor" opacity="0.65">Formel: werden + Partizip II (+ von + Dativ)</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G3</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Aktiv/Passiv unterscheiden, Passiv bilden und Wirkung erkl√§ren.</div>
                </div>
                <div class="pill"><span>üîÑ</span> <b>Grammatik</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Bildung</h3>
                    <p class="rule"><b>Passiv-Formel:</b> <b>werden</b> + <b>Partizip II</b> (optional: <b>von</b> + T√§ter im Dativ).</p>
                    <ul>
                      <li><b>Aktiv:</b> ‚ÄûDie Klasse schreibt den Test.‚Äú</li>
                      <li><b>Passiv:</b> ‚ÄûDer Test <b>wird</b> (von der Klasse) <b>geschrieben</b>.‚Äú</li>
                      <li><b>Wirkung:</b> sachlicher/objektiver.</li>
                    </ul>
                    <p class="warn"><b>Typischer Fehler:</b> ‚Äûist geschrieben‚Äú mit Passiv verwechseln. <br><b>Fix:</b> ‚Äûwird geschrieben‚Äú = Vorgang. ‚Äûist geschrieben‚Äú = Zustand.</p>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Passiv ist h√§ufig in Berichten, Anleitungen, wissenschaftlichen Texten.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="passiv">
                      <p class="qt">‚ÄûDer Brief wird morgen abgeschickt.‚Äú ‚Äì Aktiv oder Passiv?</p>
                      <div class="qa">
                        <span class="opt" data-val="aktiv">Aktiv</span>
                        <span class="opt" data-val="passiv">Passiv</span>
                      </div>
                    </div>
                    <div class="q" data-answers="werden + partizip ii">
                      <p class="qt">Welche Formel passt?</p>
                      <div class="qa">
                        <span class="opt" data-val="haben + infinitiv">haben + Infinitiv</span>
                        <span class="opt" data-val="werden + partizip ii">werden + Partizip II</span>
                        <span class="opt" data-val="sein + praeteritum">sein + Pr√§teritum</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"G4", area:"G",
        title:"Konjunktiv I & II ‚Äì indirekte Rede und Irreales",
        short:"K I: indirekte Rede ‚Ä¢ K II: Wunsch/Irreales (w√§re, h√§tte, k√∂nnte) + w√ºrde-Form.",
        keywords:["konjunktiv","indirekte rede","k1","k2","wuensche","irreales","wuerde","waere","haette","koennte"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">K I vs. K II</text>
            <g>
              <rect x="44" y="84" width="320" height="86" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="66" y="112" font-size="14" fill="currentColor" opacity="0.85" font-weight="900">Konjunktiv I</text>
              <text x="66" y="134" font-size="12" fill="currentColor" opacity="0.7">indirekte Rede</text>
              <text x="66" y="158" font-size="12" fill="currentColor" opacity="0.7">‚ÄûEr sagt, er <b>habe</b> keine Zeit.‚Äú</text>
            </g>
            <g>
              <rect x="390" y="84" width="286" height="86" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="412" y="112" font-size="14" fill="currentColor" opacity="0.85" font-weight="900">Konjunktiv II</text>
              <text x="412" y="134" font-size="12" fill="currentColor" opacity="0.7">Wunsch/Irreales</text>
              <text x="412" y="158" font-size="12" fill="currentColor" opacity="0.7">‚ÄûIch <b>w√§re</b> gern dort.‚Äú</text>
            </g>
            <text x="38" y="214" font-size="12" fill="currentColor" opacity="0.65">Ersatzform: w√ºrde + Infinitiv (wenn K II komisch klingt)</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G4</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du erkennst K I/K II und wei√üt, wof√ºr man sie verwendet.</div>
                </div>
                <div class="pill"><span>üó£Ô∏è</span> <b>Grammatik</b></div>
              </div>
              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Wann verwendet man was?</h3>
                    <p class="rule"><b>K I</b> nutzt man oft f√ºr <b>indirekte Rede</b>. <b>K II</b> f√ºr <b>Wunsch, Irreales, H√∂flichkeit</b>.</p>
                    <ul>
                      <li><b>K I:</b> ‚ÄûSie sagt, sie <b>sei</b> krank.‚Äú</li>
                      <li><b>K II:</b> ‚ÄûWenn ich Zeit <b>h√§tte</b>, ‚Ä¶‚Äú</li>
                      <li><b>w√ºrde-Form:</b> ‚ÄûIch <b>w√ºrde</b> kommen, wenn ‚Ä¶‚Äú</li>
                    </ul>
                    <p class="warn"><b>Typischer Fehler:</b> Indirekte Rede im Indikativ (‚Äûer hat‚Äú). <br><b>Fix:</b> ‚Äûer <b>habe</b> / er <b>hat</b>‚Äú (je nach Stil) ‚Äì K I wirkt ‚Äûberichtender‚Äú.</p>
                  </div>
                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">In der Schule wird K I in indirekter Rede oft erwartet.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="k i">
                      <p class="qt">‚ÄûDer Professor sagt, er <b>habe</b> keine Mail bekommen.‚Äú ‚Äì K I oder K II?</p>
                      <div class="qa">
                        <span class="opt" data-val="k i">K I</span>
                        <span class="opt" data-val="k ii">K II</span>
                      </div>
                    </div>
                    <div class="q" data-answers="k ii">
                      <p class="qt">‚ÄûIch <b>w√§re</b> gern im Urlaub.‚Äú ‚Äì K I oder K II?</p>
                      <div class="qa">
                        <span class="opt" data-val="k i">K I</span>
                        <span class="opt" data-val="k ii">K II</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"G5", area:"G",
        title:"Starke, schwache & unregelm√§√üige Verben",
        short:"So erkennst du Endungen (-te) und Vokalwechsel (ging‚Äìgegangen).",
        keywords:["starke verben","schwache verben","unregelmaessige verben","praeteritum","partizip ii","vokalwechsel","endungen"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Verbtypen im Vergleich</text>

            <g>
              <rect x="44" y="88" width="200" height="62" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="66" y="114" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">schwach</text>
              <text x="66" y="134" font-size="12" fill="currentColor" opacity="0.7">lernte ‚Äì gelernt</text>
            </g>

            <g>
              <rect x="260" y="88" width="200" height="62" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="282" y="114" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">stark</text>
              <text x="282" y="134" font-size="12" fill="currentColor" opacity="0.7">ging ‚Äì gegangen</text>
            </g>

            <g>
              <rect x="476" y="88" width="200" height="62" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="498" y="114" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">unregelm√§√üig</text>
              <text x="498" y="134" font-size="12" fill="currentColor" opacity="0.7">sein ‚Äì war ‚Äì gewesen</text>
            </g>

            <text x="38" y="210" font-size="13" fill="currentColor" opacity="0.7">
              Merke: Stark = Vokalwechsel ‚Ä¢ Schwach = -te / -t
            </text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G5</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du unterscheidest Verbtypen und bildest Pr√§teritum & Partizip II korrekt.</div>
                </div>
                <div class="pill"><span>üî§</span> <b>Grammatik</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Die drei Verbtypen</h3>

                    <p class="rule"><b>Schwache Verben</b> haben <b>-te</b> im Pr√§teritum und <b>-t</b> im Partizip II.</p>
                    <ul>
                      <li>lernen ‚Üí lern<b>te</b> ‚Üí ge<b>lern</b>t</li>
                      <li>machen ‚Üí mach<b>te</b> ‚Üí ge<b>mach</b>t</li>
                    </ul>

                    <p class="rule"><b>Starke Verben</b> √§ndern den Stammvokal und haben <b>-en</b> im Partizip II.</p>
                    <ul>
                      <li>gehen ‚Üí <b>ging</b> ‚Üí ge<b>gang</b>en</li>
                      <li>sehen ‚Üí <b>sah</b> ‚Üí ge<b>seh</b>en</li>
                    </ul>

                    <p class="warn"><b>Unregelm√§√üige Verben</b> mischen beides ‚Äì sie muss man lernen.</p>
                    <ul>
                      <li>sein ‚Üí <b>war</b> ‚Üí ge<b>wesen</b></li>
                      <li>haben ‚Üí <b>hatte</b> ‚Üí ge<b>habt</b></li>
                    </ul>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Tipp: Schau immer zuerst auf das <b>Partizip II</b>.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="stark">
                      <p class="qt">‚Äûfahren ‚Äì fuhr ‚Äì gefahren‚Äú ist ‚Ä¶</p>
                      <div class="qa">
                        <span class="opt" data-val="schwach">schwach</span>
                        <span class="opt" data-val="stark">stark</span>
                        <span class="opt" data-val="regelmaessig">regelm√§√üig</span>
                      </div>
                    </div>

                    <div class="q" data-answers="schwach">
                      <p class="qt">‚Äûfragen ‚Äì fragte ‚Äì gefragt‚Äú ist ‚Ä¶</p>
                      <div class="qa">
                        <span class="opt" data-val="stark">stark</span>
                        <span class="opt" data-val="schwach">schwach</span>
                        <span class="opt" data-val="unregelmaessig">unregelm√§√üig</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"G6", area:"G",
        title:"Zeiten-Mix ‚Äì welche Zeit passt wann?",
        short:"Pr√§teritum vs. Perfekt, Pr√§sens mit Zukunft, Futur ‚Äì so entscheidest du richtig.",
        keywords:["zeiten mix","zeitwahl","praeteritum","perfekt","praesens","futur","erzaehlung","bericht","gespraech","signalwoerter"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Zeitwahl ‚Äì schneller Entscheidungsweg</text>

            <g>
              <rect x="44" y="88" width="632" height="44" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="66" y="116" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">Frage:</text>
              <text x="126" y="116" font-size="13" fill="currentColor" opacity="0.72">Erz√§hlst du (Story) oder berichtest du (Gespr√§ch/Alltag)?</text>
            </g>

            <g opacity="0.9">
              <path d="M220 142 L140 190" stroke="currentColor" stroke-opacity="0.25" stroke-width="3"/>
              <polygon points="140,190 156,186 148,200" fill="currentColor" opacity="0.25"/>
              <path d="M500 142 L580 190" stroke="currentColor" stroke-opacity="0.25" stroke-width="3"/>
              <polygon points="580,190 564,186 572,200" fill="currentColor" opacity="0.25"/>
            </g>

            <g>
              <rect x="44" y="190" width="280" height="52" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="66" y="220" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">Erz√§hlung</text>
              <text x="66" y="240" font-size="12" fill="currentColor" opacity="0.7">oft Pr√§teritum (‚ÄûEr ging ‚Ä¶‚Äú)</text>
            </g>

            <g>
              <rect x="396" y="190" width="280" height="52" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="418" y="220" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">Gespr√§ch/Bericht</text>
              <text x="418" y="240" font-size="12" fill="currentColor" opacity="0.7">oft Perfekt (‚ÄûIch habe ‚Ä¶‚Äú)</text>
            </g>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G6</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du w√§hlst passend die Zeitform ‚Äì je nach Situation und Textart.</div>
                </div>
                <div class="pill"><span>üß≠</span> <b>Grammatik</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Die wichtigsten Entscheidungen</h3>

                    <p class="rule"><b>Pr√§teritum</b> = h√§ufig in <b>Erz√§hlungen</b> (Story, Bericht in schriftlicher Form).<br>
                    <b>Perfekt</b> = h√§ufig in <b>Gespr√§chen</b> und im Alltag.</p>

                    <ul>
                      <li><b>Pr√§teritum:</b> ‚ÄûGestern <b>ging</b> ich nach Hause.‚Äú</li>
                      <li><b>Perfekt:</b> ‚ÄûIch <b>bin</b> nach Hause <b>gegangen</b>.‚Äú</li>
                      <li><b>Pr√§sens</b> kann Zukunft bedeuten: ‚ÄûMorgen <b>schreibe</b> ich eine Schularbeit.‚Äú</li>
                      <li><b>Futur I</b> nutzt man oft f√ºr Pl√§ne/Vermutungen: ‚ÄûIch <b>werde</b> das schaffen.‚Äú</li>
                    </ul>

                    <p class="warn"><b>Typischer Fehler:</b> Im selben Absatz ohne Grund wild wechseln.<br>
                    <b>Fix:</b> Pro Textteil eine Hauptzeit beibehalten (Wechsel nur mit klarer Funktion).</p>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Signalw√∂rter helfen ‚Äì aber entscheidend ist oft die <b>Textart</b> (Erz√§hlung vs. Gespr√§ch).</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="praeteritum">
                      <p class="qt">Du schreibst eine Erz√§hlung. Welche Zeit passt am besten?</p>
                      <div class="qa">
                        <span class="opt" data-val="praesens">Pr√§sens</span>
                        <span class="opt" data-val="praeteritum">Pr√§teritum</span>
                        <span class="opt" data-val="futur i">Futur I</span>
                      </div>
                    </div>

                    <div class="q" data-answers="praesens">
                      <p class="qt">‚ÄûMorgen ____ ich mit Freunden ins Kino.‚Äú (Zukunft gemeint)</p>
                      <div class="qa">
                        <span class="opt" data-val="praesens">gehe</span>
                        <span class="opt" data-val="perfekt">bin gegangen</span>
                        <span class="opt" data-val="plusquamperfekt">war gegangen</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      }
      ,
      {
        id:"G7", area:"G",
        title:"Aktiv/Passiv ‚Äì Wirkung im Text",
        short:"Aktiv wirkt lebendiger, Passiv sachlicher. So nutzt du beides bewusst.",
        keywords:["aktiv passiv wirkung","stil","objektiv","sachlich","taeter","handlung","wissenschaft","bericht"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Wirkungs-Regler</text>

            <text x="46" y="112" font-size="13" fill="currentColor" opacity="0.75">lebendig / pers√∂nlich</text>
            <text x="530" y="112" font-size="13" fill="currentColor" opacity="0.75">sachlich / objektiv</text>

            <line x1="70" y1="150" x2="650" y2="150" stroke="currentColor" stroke-opacity="0.22" stroke-width="10" stroke-linecap="round"/>
            <circle cx="210" cy="150" r="16" fill="none" stroke="currentColor" stroke-opacity="0.30" stroke-width="3"/>
            <text x="188" y="190" font-size="12" fill="currentColor" opacity="0.7">Aktiv</text>

            <circle cx="520" cy="150" r="16" fill="none" stroke="currentColor" stroke-opacity="0.30" stroke-width="3"/>
            <text x="500" y="190" font-size="12" fill="currentColor" opacity="0.7">Passiv</text>

            <text x="38" y="230" font-size="12" fill="currentColor" opacity="0.65">Tipp: Passiv ist sinnvoll, wenn der T√§ter unwichtig/unbekannt ist.</text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G7</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du entscheidest bewusst, ob Aktiv oder Passiv besser zur Textwirkung passt.</div>
                </div>
                <div class="pill"><span>üéõÔ∏è</span> <b>Grammatik</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Wirkung ‚Äì kurz & klar</h3>
                    <p class="rule"><b>Aktiv</b> betont den <b>T√§ter</b> (wer handelt?) und wirkt oft direkter.<br>
                    <b>Passiv</b> betont die <b>Handlung/den Vorgang</b> und wirkt oft sachlicher.</p>

                    <ul>
                      <li><b>Aktiv:</b> ‚ÄûDie Sch√ºler schreiben den Test.‚Äú ‚Üí Fokus: Sch√ºler</li>
                      <li><b>Passiv:</b> ‚ÄûDer Test wird geschrieben.‚Äú ‚Üí Fokus: Test/Vorgang</li>
                      <li><b>Passiv sinnvoll</b> bei Anleitungen/Berichten: ‚ÄûDie Schraube wird festgezogen.‚Äú</li>
                    </ul>

                    <p class="warn"><b>Typischer Fehler:</b> Zu viel Passiv ‚Üí Text wird schwer und unpers√∂nlich.<br>
                    <b>Fix:</b> Misch bewusst: Aktiv f√ºr Dynamik, Passiv f√ºr Objektivit√§t.</p>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">In Er√∂rterungen: Aktiv wirkt oft √ºberzeugender ‚Äì Passiv nur, wenn es wirklich passt.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="passiv">
                      <p class="qt">Welche Form klingt sachlicher?</p>
                      <div class="qa">
                        <span class="opt" data-val="aktiv">‚ÄûDer Lehrer kontrolliert die Tests.‚Äú</span>
                        <span class="opt" data-val="passiv">‚ÄûDie Tests werden kontrolliert.‚Äú</span>
                      </div>
                    </div>

                    <div class="q" data-answers="aktiv">
                      <p class="qt">Welche Form klingt lebendiger?</p>
                      <div class="qa">
                        <span class="opt" data-val="aktiv">‚ÄûDie Klasse diskutiert das Thema.‚Äú</span>
                        <span class="opt" data-val="passiv">‚ÄûDas Thema wird diskutiert.‚Äú</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"G8", area:"G",
        title:"Synonyme & pr√§ziser Ausdruck",
        short:"Wortfelder nutzen: weniger Wiederholungen, treffender schreiben (statt ‚Äûgut/sch√∂n/machen‚Äú).",
        keywords:["synonyme","wortfeld","ausdruck","praeziser ausdruck","stil","wortschatz","variation","treffend","wiederholungen"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Wortfeld statt Wiederholung</text>

            <g>
              <rect x="58" y="94" width="150" height="44" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="96" y="122" font-size="13" fill="currentColor" opacity="0.9" font-weight="900">gut</text>

              <path d="M208 116 L280 86" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <path d="M208 116 L280 116" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <path d="M208 116 L280 146" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>

              <rect x="280" y="68" width="190" height="40" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="298" y="93" font-size="12" fill="currentColor" opacity="0.75">√ºberzeugend</text>

              <rect x="280" y="104" width="190" height="40" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="298" y="129" font-size="12" fill="currentColor" opacity="0.75">wirksam</text>

              <rect x="280" y="140" width="190" height="40" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="298" y="165" font-size="12" fill="currentColor" opacity="0.75">fair</text>

              <rect x="494" y="104" width="170" height="40" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <text x="512" y="129" font-size="12" fill="currentColor" opacity="0.75">sinnvoll</text>
            </g>

            <text x="38" y="228" font-size="12" fill="currentColor" opacity="0.65">
              Tipp: Das ‚Äûbeste‚Äú Synonym ist das, das im Satz wirklich passt.
            </text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">G8</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du formulierst genauer und abwechslungsreicher (und vermeidest ‚Äûgut/sch√∂n/machen‚Äú).</div>
                </div>
                <div class="pill"><span>üßæ</span> <b>Wortschatz</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Die 3-Schritt-Methode</h3>
                    <p class="rule"><b>Merksatz:</b> Ein Synonym ist nicht ‚Äûeinfach ein anderes Wort‚Äú ‚Äì es muss <b>im Kontext passen</b>.</p>
                    <ol style="margin:0 0 0 18px; color:var(--muted); font-size:14px; line-height:1.6">
                      <li><b>Basiswort</b> finden (z.B. ‚Äûgut‚Äú / ‚Äûsch√∂n‚Äú / ‚Äûmachen‚Äú).</li>
                      <li><b>Bedeutung kl√§ren:</b> Was genau meinst du? (z.B. fair? wirksam? √ºberzeugend?)</li>
                      <li><b>Satztest:</b> Laut lesen ‚Äì klingt es nat√ºrlich und genau?</li>
                    </ol>

                    <p class="warn" style="margin-top:10px"><b>Typischer Fehler:</b> ‚ÄûSynonym‚Äú einsetzen, das komisch/falsch wirkt.<br>
                    <b>Fix:</b> Satztest + notfalls nachschlagen und in eigene Worte √ºbersetzen.</p>

                    <h3 style="margin-top:14px">Praktische Wortfelder</h3>
                    <ul>
                      <li><b>gut</b> ‚Üí √ºberzeugend, sinnvoll, wirksam, fair</li>
                      <li><b>sch√∂n</b> ‚Üí gelungen, attraktiv, beeindruckend, stimmig</li>
                      <li><b>machen</b> ‚Üí erstellen, bewirken, ver√§ndern, ausl√∂sen</li>
                    </ul>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">In Er√∂rterungen: Pr√§zise W√∂rter machen Argumente st√§rker.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="ueberzeugend">
                      <p class="qt">‚ÄûDas Argument ist ___.‚Äú ‚Äì Was passt am besten?</p>
                      <div class="qa">
                        <span class="opt" data-val="glatt">glatt</span>
                        <span class="opt" data-val="ueberzeugend">√ºberzeugend</span>
                        <span class="opt" data-val="laut">laut</span>
                      </div>
                    </div>

                    <div class="q" data-answers="ausloesen">
                      <p class="qt">‚ÄûDie Regel ___ Stress.‚Äú ‚Äì welches Verb ist treffend?</p>
                      <div class="qa">
                        <span class="opt" data-val="ausloesen">l√∂st ‚Ä¶ aus</span>
                        <span class="opt" data-val="sitzen">sitzt</span>
                        <span class="opt" data-val="malen">malt</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"R1", area:"R",
        title:"Fremdw√∂rter ‚Äì Bedeutung, Schreibweise, sichere Nutzung",
        short:"Fremdwort = korrekt schreiben + Bedeutung kennen + passend einsetzen.",
        keywords:["fremdwoerter","bedeutung","schreibweise","wortschatz","duden","definition","synonym","liste","kontext"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">3-Spalten-Prinzip (Lernzettel)</text>

            <g>
              <rect x="44" y="92" width="200" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="66" y="122" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">Fremdwort</text>

              <rect x="260" y="92" width="200" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="282" y="122" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">Bedeutung (kurz)</text>

              <rect x="476" y="92" width="200" height="52" rx="16" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="498" y="122" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">deutsches Wort</text>

              <text x="66" y="178" font-size="12" fill="currentColor" opacity="0.7">Methode</text>
              <text x="282" y="178" font-size="12" fill="currentColor" opacity="0.7">Vorgehensweise</text>
              <text x="498" y="178" font-size="12" fill="currentColor" opacity="0.7">Vorgehen</text>
            </g>

            <text x="38" y="228" font-size="12" fill="currentColor" opacity="0.65">
              Regel: Wenn du das Wort nicht erkl√§ren kannst, verwende es (noch) nicht.
            </text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">R1</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Fremdw√∂rter so lernen, dass du sie wirklich beherrschst: <b>Bedeutung</b> + <b>Schreibung</b> + <b>Einsatz</b>.</div>
                </div>
                <div class="pill"><span>üî§</span> <b>Rechtschreibung</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>So lernst du Fremdw√∂rter richtig</h3>

                    <p class="rule"><b>Merksatz:</b> Ein Fremdwort ist erst ‚Äûdeins‚Äú, wenn du es jemandem aus deiner Klasse <b>einfach erkl√§ren</b> kannst.</p>

                    <ul>
                      <li><b>1) Korrekt notieren:</b> Schreibweise genau abschreiben.</li>
                      <li><b>2) Bedeutung:</b> in <b>eigenen Worten</b> (nicht nur kopieren).</li>
                      <li><b>3) deutsches Wort/Synonym:</b> ein einfaches Ersatzwort finden.</li>
                      <li><b>4) Mini-Satz:</b> ein sinnvoller Satz, der zeigt, dass du es verstanden hast.</li>
                    </ul>

                    <p class="warn"><b>Typischer Fehler:</b> Fremdw√∂rter als ‚ÄûDeko‚Äú verwenden.<br>
                    <b>Fix:</b> Nur nutzen, wenn du es erkl√§ren k√∂nntest ‚Äì sonst: nachschlagen oder weglassen.</p>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}

                    <div class="mini" style="margin-top:12px">
                      <div class="q" data-answers="vorgehensweise">
                        <p class="qt">Mini-Check: ‚ÄûMethode‚Äú bedeutet am ehesten ‚Ä¶</p>
                        <div class="qa">
                          <span class="opt" data-val="vorgehensweise">Vorgehensweise</span>
                          <span class="opt" data-val="haustier">Haustier</span>
                          <span class="opt" data-val="regenschirm">Regenschirm</span>
                        </div>
                      </div>
                    </div>

                    <p class="footer-note">Tipp: Duden/W√∂rterbuch nutzen ‚Äì aber Bedeutung danach <b>vereinfachen</b> und in eigene Worte schreiben.</p>
                  </div>
                </div>
              </div>
            </div>`;
        }
      },
      {
        id:"R2", area:"R",
        title:"Diktat & Abschreiben ‚Äì richtig lernen mit Fehlerliste",
        short:"So schreibst du konzentriert ab und verbesserst dich mit einer sinnvollen Fehlerliste.",
        keywords:["diktat","abschreiben","fehlerliste","rechtschreibung","konzentriert","kontrollieren","lernen aus fehlern"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Lern-Schleife statt Fehler z√§hlen</text>

            <g>
              <rect x="44" y="92" width="180" height="44" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="68" y="120" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">abschreiben</text>

              <path d="M224 114 L296 114" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <polygon points="296,114 282,106 282,122" fill="currentColor" opacity="0.25"/>

              <rect x="306" y="92" width="180" height="44" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="330" y="120" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">kontrollieren</text>

              <path d="M486 114 L558 114" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <polygon points="558,114 544,106 544,122" fill="currentColor" opacity="0.25"/>

              <rect x="568" y="92" width="180" height="44" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="590" y="120" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">Fehlerliste</text>

              <path d="M396 150 C396 196, 120 196, 120 150" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <polygon points="120,150 132,162 108,162" fill="currentColor" opacity="0.22"/>
            </g>

            <text x="38" y="224" font-size="12" fill="currentColor" opacity="0.65">
              Ziel: Fehler verstehen ‚Üí gezielt vermeiden.
            </text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">R2</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du schreibst sorgf√§ltig ab und nutzt Fehler als <b>Lernchance</b>.</div>
                </div>
                <div class="pill"><span>‚úèÔ∏è</span> <b>Rechtschreibung</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Richtig abschreiben (Schritt f√ºr Schritt)</h3>
                    <ul>
                      <li><b>1) Sinnabschnitte:</b> Nicht Wort f√ºr Wort ‚Äì ganze Sinneinheiten.</li>
                      <li><b>2) Blicktechnik:</b> Lesen ‚Üí merken ‚Üí schreiben ‚Üí <b>nicht zur√ºckschauen</b>.</li>
                      <li><b>3) Tempo:</b> Lieber langsam und richtig als schnell und fehlerhaft.</li>
                    </ul>

                    <p class="rule"><b>Merksatz:</b> Abschreiben ist eine <b>Konzentrations√ºbung</b>, kein Abschreib-Rennen.</p>

                    <p class="warn"><b>Typischer Fehler:</b> W√§hrend des Schreibens st√§ndig hochschauen.<br>
                    <b>Fix:</b> Erst schreiben, dann kontrollieren.</p>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">Die Fehlerliste macht aus einem Fehler einen Lernschritt.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Die Fehlerliste (das Herzst√ºck)</h3>
                  <ul>
                    <li><b>Falsches Wort</b> notieren</li>
                    <li><b>Richtiges Wort</b> daneben schreiben</li>
                    <li><b>Warum?</b> (z.B. Fremdwort, Gro√ü/Klein, Doppelkonsonant)</li>
                  </ul>

                  <p class="rule"><b>Regel:</b> Nur <b>echte Fehler</b> kommen in die Fehlerliste ‚Äì keine Sch√∂nheitskorrekturen.</p>

                  <div class="mini">
                    <div class="q" data-answers="kontrollieren">
                      <p class="qt">Was kommt nach dem Abschreiben?</p>
                      <div class="qa">
                        <span class="opt" data-val="abgeben">Abgeben</span>
                        <span class="opt" data-val="kontrollieren">Kontrollieren</span>
                        <span class="opt" data-val="neu schreiben">Neu schreiben</span>
                      </div>
                    </div>

                    <div class="q" data-answers="lernen">
                      <p class="qt">Wozu dient die Fehlerliste vor allem?</p>
                      <div class="qa">
                        <span class="opt" data-val="noten">F√ºr Noten</span>
                        <span class="opt" data-val="lernen">Zum Lernen</span>
                        <span class="opt" data-val="vergleich">Zum Vergleichen</span>
                      </div>
                    </div>
                  </div>

                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"R3", area:"R",
        title:"Fremdw√∂rter im Kontext ‚Äì passt das Wort wirklich?",
        short:"So erkennst du, ob ein Fremdwort sinnvoll ist (und wie du Unsicherheiten kl√§rst).",
        keywords:["fremdwoerter im kontext","kontext","passen","bedeutung","stil","duden","ersatzwort","ampel","formulierungen"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Kontext-Ampel</text>

            <g>
              <rect x="60" y="92" width="600" height="48" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.20" stroke-width="2"/>
              <text x="82" y="122" font-size="13" fill="currentColor" opacity="0.75">Frage:</text>
              <text x="140" y="122" font-size="13" fill="currentColor" opacity="0.75">Kann ich das Wort in eigenen Worten erkl√§ren?</text>
            </g>

            <g>
              <rect x="78" y="156" width="176" height="62" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="104" y="186" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">üü¢ passt</text>
              <text x="104" y="206" font-size="12" fill="currentColor" opacity="0.7">verwenden</text>

              <rect x="272" y="156" width="176" height="62" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="298" y="186" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">üü° unsicher</text>
              <text x="298" y="206" font-size="12" fill="currentColor" opacity="0.7">nachschlagen</text>

              <rect x="466" y="156" width="176" height="62" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="492" y="186" font-size="14" fill="currentColor" opacity="0.9" font-weight="900">üî¥ falsch</text>
              <text x="492" y="206" font-size="12" fill="currentColor" opacity="0.7">ersetzen</text>
            </g>

            <text x="38" y="238" font-size="12" fill="currentColor" opacity="0.65">
              Merke: Fremdw√∂rter st√§rken nur dann den Text, wenn sie genau passen.
            </text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">R3</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du verwendest Fremdw√∂rter <b>treffsicher</b> ‚Äì nicht als Deko.</div>
                </div>
                <div class="pill"><span>üß©</span> <b>Rechtschreibung</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>So pr√ºfst du ein Fremdwort (3 Schritte)</h3>

                    <p class="rule"><b>Merksatz:</b> Wenn du es nicht erkl√§ren kannst, ist es im Text meistens zu riskant.</p>

                    <ul>
                      <li><b>1) Bedeutungs-Check:</b> Kannst du es in eigenen Worten erkl√§ren?</li>
                      <li><b>2) Ersatzwort-Test:</b> Welches einfache deutsche Wort passt?</li>
                      <li><b>3) Satztest:</b> Laut lesen ‚Äì klingt es nat√ºrlich und genau?</li>
                    </ul>

                    <p class="warn"><b>Typischer Fehler:</b> Ein Wort klingt ‚Äûschlau‚Äú, passt aber nicht zur Bedeutung.<br>
                    <b>Fix:</b> Nachschlagen und mit einem einfachen Satz pr√ºfen.</p>

                    <h3 style="margin-top:14px">Beispiel</h3>
                    <ul>
                      <li>‚ÄûDas war eine <b>Alternative</b>.‚Äú ‚Üí Alternative wozu? <i>Besser:</i> ‚ÄûEine Alternative <b>zum</b> Handyverbot.‚Äú</li>
                      <li>‚ÄûEr hatte viel <b>Renommee</b>.‚Äú ‚Üí bedeutet: hohes Ansehen.</li>
                    </ul>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}
                    <p class="footer-note">üü° unsicher = kurz nachschlagen (Duden/W√∂rterbuch) und Bedeutung vereinfachen.</p>
                  </div>
                </div>

                <div class="box" style="margin-top:14px">
                  <h3>Mini-Check</h3>
                  <div class="mini">
                    <div class="q" data-answers="nachschlagen">
                      <p class="qt">Du bist dir bei einem Fremdwort unsicher. Was ist der beste n√§chste Schritt?</p>
                      <div class="qa">
                        <span class="opt" data-val="einfach nehmen">Einfach nehmen</span>
                        <span class="opt" data-val="nachschlagen">Nachschlagen</span>
                        <span class="opt" data-val="ignorieren">Ignorieren</span>
                      </div>
                    </div>

                    <div class="q" data-answers="ersetzen">
                      <p class="qt">Du merkst: Du kannst das Wort nicht erkl√§ren. Was ist am sinnvollsten?</p>
                      <div class="qa">
                        <span class="opt" data-val="ersetzen">Einfaches Ersatzwort verwenden</span>
                        <span class="opt" data-val="drinlassen">Drinlassen</span>
                        <span class="opt" data-val="mehr fremdwoerter">Noch ein Fremdwort dazu</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>`;
        }
      },
      {
        id:"R4", area:"R",
        title:"Fremdwort ‚Üî Bedeutung zuordnen",
        short:"So ordnest du Fremdw√∂rter sicher zu ‚Äì erst Bedeutung kl√§ren, dann verbinden.",
        keywords:["zuordnung","fremdwort bedeutung","matching","bedeutung","wortschatz","duden","definition"],
        content(){
          const graphic = svgFrame(`
            <text x="38" y="58" font-size="18" fill="currentColor" opacity="0.85" font-weight="700">Matching-Strategie</text>

            <g>
              <rect x="54" y="92" width="250" height="44" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="76" y="120" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">1) Bedeutung lesen</text>

              <path d="M304 114 L372 114" stroke="currentColor" stroke-opacity="0.25" stroke-width="2"/>
              <polygon points="372,114 358,106 358,122" fill="currentColor" opacity="0.25"/>

              <rect x="382" y="92" width="280" height="44" rx="14" fill="none" stroke="currentColor" stroke-opacity="0.22" stroke-width="2"/>
              <text x="404" y="120" font-size="13" fill="currentColor" opacity="0.85" font-weight="900">2) Fremdwort suchen</text>
            </g>

            <g>
              <rect x="54" y="156" width="608" height="64" rx="18" fill="none" stroke="currentColor" stroke-opacity="0.18" stroke-width="2"/>
              <text x="76" y="186" font-size="12" fill="currentColor" opacity="0.72">Tipp:</text>
              <text x="120" y="186" font-size="12" fill="currentColor" opacity="0.72">Schlie√üe zuerst die eindeutigsten Paare, dann die restlichen.</text>
              <text x="120" y="206" font-size="12" fill="currentColor" opacity="0.72">Wenn du unsicher bist: Wort in eigenen Worten erkl√§ren.</text>
            </g>

            <text x="38" y="238" font-size="12" fill="currentColor" opacity="0.65">
              Merke: Nicht ‚Äûraten‚Äú ‚Äì erst kl√§ren, dann zuordnen.
            </text>
          `);

          return `
            <div class="card">
              <div class="hd">
                <div>
                  <h2><span class="code">R4</span> ${escapeHTML(this.title)}</h2>
                  <div class="small">Ziel: Du ordnest Bedeutungen sicher zu und erkennst ‚ÄûFallen‚Äú bei √§hnlichen W√∂rtern.</div>
                </div>
                <div class="pill"><span>üß†</span> <b>Rechtschreibung</b></div>
              </div>

              <div class="bd">
                <div class="cols">
                  <div class="box">
                    <h3>Strategie (statt raten)</h3>
                    <p class="rule"><b>Merksatz:</b> Lies zuerst die Bedeutungen. Ordne erst zu, wenn du sie in eigenen Worten erkl√§ren kannst.</p>
                    <ul>
                      <li><b>1)</b> Bedeutungen kurz in eigenen Worten zusammenfassen.</li>
                      <li><b>2)</b> Eindeutige Paare verbinden.</li>
                      <li><b>3)</b> Rest √ºber Ausschluss l√∂sen.</li>
                      <li><b>4)</b> Unsicher? ‚Üí nachschlagen, dann vereinfachen.</li>
                    </ul>

                    <p class="warn"><b>Typischer Fehler:</b> W√∂rter nur nach ‚ÄûKlang‚Äú zuordnen.<br>
                    <b>Fix:</b> Bedeutung muss zum Kontext passen (siehe R3).</p>

                    <h3 style="margin-top:14px">Beispiel-Paare</h3>
                    <ul>
                      <li><b>Renommee</b> ‚Üí hohes Ansehen</li>
                      <li><b>Alternative</b> ‚Üí andere M√∂glichkeit</li>
                      <li><b>Methode</b> ‚Üí Vorgehensweise</li>
                    </ul>
                  </div>

                  <div class="box">
                    <h3>Grafik</h3>
                    ${graphic}

                    <div class="mini" style="margin-top:12px">
                      <div class="q" data-answers="anderemoeglichkeit">
                        <p class="qt">Mini-Check: ‚ÄûAlternative‚Äú bedeutet am ehesten ‚Ä¶</p>
                        <div class="qa">
                          <span class="opt" data-val="anderemoeglichkeit">andere M√∂glichkeit</span>
                          <span class="opt" data-val="obstsalat">Obstsalat</span>
                          <span class="opt" data-val="ferien">Ferien</span>
                        </div>
                      </div>
                    </div>

                    <p class="footer-note">Tipp: Wenn zwei W√∂rter √§hnlich wirken, pr√ºfe die Bedeutung mit einem Beispielsatz.</p>
                  </div>
                </div>

              </div>
            </div>`;
        }
      }
];
/* ---------- APP BOOTSTRAP (render + navigation + search) ---------- */

const modulesById = new Map(modules.map(m => [m.id, m]));

// Precompute searchable text
const searchText = new Map(
  modules.map(m => {
    const all = [
      m.id,
      m.area,
      m.title,
      m.short,
      ...(Array.isArray(m.keywords) ? m.keywords : [])
    ].filter(Boolean).join(" ");
    return [m.id, normalize(all)];
  })
);

const state = {
  filter: "ALL",      // ALL | S | G | R
  query: "",
  openId: ""          // current module id
};

const elItems = $("#items");
const elView = $("#view");
const elCrumb = $("#crumb");
const elSearch = $("#searchInput");
const elCountNow = $("#countNow");
const elCountAll = $("#countAll");

function setCrumb(parts){
  // parts: ["Start","√úbersicht"] or ["Start","Module","G3"]
  elCrumb.innerHTML = parts
    .map((p,i) => i === parts.length-1 ? `<b>${escapeHTML(p)}</b>` : `<span>${escapeHTML(p)}</span>`)
    .join(`<span>‚Ä∫</span>`);
}

function moduleBadge(area){
  if(area === "S") return `<span>‚úçÔ∏è</span> <b>Schreiben</b>`;
  if(area === "G") return `<span>üß†</span> <b>Grammatik/Wortschatz</b>`;
  if(area === "R") return `<span>‚úÖ</span> <b>Rechtschreibung</b>`;
  return `<span>üìö</span> <b>Modul</b>`;
}

function overviewHTML(){
  const counts = {
    S: modules.filter(m => m.area==="S").length,
    G: modules.filter(m => m.area==="G").length,
    R: modules.filter(m => m.area==="R").length,
  };

  return `
    <div class="card">
      <div class="hd">
        <div>
          <h2>√úbersicht</h2>
          <div class="small">
            Hier findest du zu jedem Plan-Punkt (au√üer <b>Lesen</b>) eine Lernunterlage:
            <b>Erkl√§rungen</b>, <b>Grafiken</b> und <b>Mini-Checks</b>.
          </div>
        </div>
        <div class="pill"><span>üè´</span> <b>HoS</b></div>
      </div>

      <div class="bd">
        <div class="cols">
          <div class="box">
            <h3>So nutzt du das Lernstudio</h3>
            <ul>
              <li><b>1)</b> Suchfeld: Begriffe (z.B. ‚ÄûPassiv‚Äú, ‚ÄûKonjunktiv‚Äú, ‚ÄûSynonyme‚Äú) oder Codes (z.B. <b>G3</b>).</li>
              <li><b>2)</b> Filter: Schreiben / Grammatik / Rechtschreibung.</li>
              <li><b>3)</b> Modul √∂ffnen ‚Üí Erkl√§rung + Grafik + Mini-Check.</li>
            </ul>
            <p class="rule"><b>Tipp:</b> Wenn du das Modul verstanden hast, geh danach in die √úbungs-Apps/Arbeitsbl√§tter.</p>
          </div>

          <div class="box">
            <h3>Module im √úberblick</h3>
            <div class="mini">
              <div class="qa" style="flex-wrap:wrap">
                <span class="opt on good" style="cursor:default">‚úçÔ∏è Schreiben: ${counts.S}</span>
                <span class="opt on good" style="cursor:default">üß† Grammatik/Wortschatz: ${counts.G}</span>
                <span class="opt on good" style="cursor:default">‚úÖ Rechtschreibung: ${counts.R}</span>
              </div>
            </div>
            <p class="footer-note">Nutze üîó ‚ÄûLink‚Äú, um direkt zu einem Modul zu springen (Hash in der URL).</p>
          </div>
        </div>
      </div>
    </div>
  `;
}

function matches(m){
  if(state.filter !== "ALL" && m.area !== state.filter) return false;
  const q = normalize(state.query.trim());
  if(!q) return true;
  const text = searchText.get(m.id) || "";
  return text.includes(q);
}

function renderList(){
  const filtered = modules.filter(matches);

  elCountAll.textContent = String(modules.length);
  elCountNow.textContent = String(filtered.length);

  elItems.innerHTML = filtered.map(m => `
    <div class="item ${m.id === state.openId ? "active" : ""}" data-id="${m.id}" role="button" tabindex="0" aria-label="Modul ${m.id}">
      <div class="tag">${escapeHTML(m.id)}</div>
      <div class="meta">
        <div class="row">
          <div class="name">${escapeHTML(m.title)}</div>
          <div class="pill">${moduleBadge(m.area)}</div>
        </div>
        <div class="desc">${escapeHTML(m.short || "")}</div>
      </div>
    </div>
  `).join("");

  // click + keyboard
  $$(".item", elItems).forEach(it => {
    const id = it.getAttribute("data-id");
    it.addEventListener("click", () => openModule(id, true));
    it.addEventListener("keydown", (e) => {
      if(e.key === "Enter" || e.key === " "){
        e.preventDefault();
        openModule(id, true);
      }
    });
  });
}

function openOverview(pushHash=true){
  state.openId = "";
  if(pushHash) setHash("");
  setCrumb(["Start","√úbersicht"]);
  elView.innerHTML = overviewHTML();
  renderList();
}

function openModule(id, pushHash=true){
  const m = modulesById.get(id);
  if(!m){
    openOverview(true);
    return;
  }
  state.openId = id;
  if(pushHash) setHash(id);

  setCrumb(["Start","Modul", id]);
  const html = (typeof m.content === "function") ? m.content.call(m) : String(m.content || "");
  elView.innerHTML = html;

  // wire mini checks inside the module
  wireMiniChecks(elView);

  renderList();
}

function applyHash(){
  const id = currentHash();
  if(id && modulesById.has(id)) openModule(id, false);
  else openOverview(false);
}

function setFilter(next){
  state.filter = next;
  // chip UI
  $$(".chip").forEach(c => c.classList.toggle("active", c.getAttribute("data-filter") === next));
  renderList();

  // if open module is filtered out, keep content but list may not show it ‚Äî ok.
}

function init(){
  // Search
  elSearch.addEventListener("input", () => {
    state.query = elSearch.value || "";
    renderList();
  });

  // Filter chips
  $$(".chip").forEach(c => {
    c.addEventListener("click", () => setFilter(c.getAttribute("data-filter") || "ALL"));
  });

  // Top buttons
  $("#homeBtn").addEventListener("click", () => openOverview(true));
  $("#printBtn").addEventListener("click", () => window.print());
  $("#copyLinkBtn").addEventListener("click", async () => {
    try{
      await copyToClipboard(location.href);
      const btn = $("#copyLinkBtn");
      const old = btn.textContent;
      btn.textContent = "‚úÖ Kopiert";
      setTimeout(() => btn.textContent = old, 900);
    }catch(e){
      alert("Kopieren hat nicht geklappt. Markiere die URL oben und kopiere sie manuell.");
    }
  });

  // Hash navigation (back/forward)
  window.addEventListener("hashchange", applyHash);

  // Initial render
  elCountAll.textContent = String(modules.length);
  applyHash();
  renderList();
}

// GO
init();

  </script>
</body>
</html>
