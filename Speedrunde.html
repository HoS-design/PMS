<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Speedrunde â€“ Zeitformen</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
      --subject-color:#ef4444;
  --bg:#f2f4f7;
  --surface:#ffffff;
  --ink:#1e293b;
  --muted:#64748b;
  --line:#e2e8f0;
  --accent:#3b82f6;
  --accent-soft:#eff6ff;
  --success:#10b981;
  --danger:#ef4444;
  --radius:16px;
  --shadow-md:0 4px 6px -1px rgba(0,0,0,0.08), 0 2px 4px -1px rgba(0,0,0,0.04);
  --card:var(--surface);
  --text:var(--ink);
  --ok:var(--success);
  --no:var(--danger);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  max-width:900px;
  margin:0 auto;
  padding:20px;
  position:relative;
}
.meme{
  position:absolute;
  right:16px;
  top:14px;
  width:110px;
  image-rendering:pixelated;
  transform:rotate(4deg);
}
.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  background:var(--accent-soft);
  border:1px solid var(--line);
  color:var(--ink);
  margin-bottom:10px;
}
main{
  max-width:900px;
  margin:0 auto;
  padding:16px;
}
.card{
  background:var(--card);
  border-radius:18px;
  padding:16px;
  border:1px solid var(--line);
  box-shadow:var(--shadow-md);
}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.btn{
  padding:10px 16px;
  border-radius:14px;
  border:1px solid var(--accent);
  font-weight:700;
  cursor:pointer;
  background:var(--accent);
  color:white;
}
.btn.secondary{
  background:var(--surface);
  color:var(--ink);
  border-color:var(--line);
}
.option{
  padding:10px;
  border-radius:12px;
  border:1px solid var(--line);
  background:var(--surface);
  color:var(--ink);
  cursor:pointer;
  text-align:left;
}
.option.ok{background:#ecfdf5;border-color:#a7f3d0}
.option.no{background:#fef2f2;border-color:#fecaca}
#question{font-size:1.15rem;margin:14px 0 12px}
#answers{display:grid;gap:8px}
#resultBox{
  display:none;
  margin-top:14px;
  padding:12px;
  border-radius:14px;
  border:1px dashed var(--line);
  background:var(--surface);
}
.mini{
  display:none;
  margin-top:16px;
  padding:12px;
  border-radius:16px;
  border:1px solid var(--line);
  background:var(--surface);
}
.miniBox{
  margin:10px 0;
  padding:16px;
  min-height:110px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:16px;
  border:1px solid var(--line);
  cursor:pointer;
  user-select:none;
}
.miniBox.wait{background:var(--accent-soft)}
.miniBox.go{background:#fee2e2}
.small{color:var(--muted);font-size:.95rem}

    .app-header {
      padding: 12px 24px;
      background: var(--surface);
      border-bottom: 1px solid var(--line);
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 12px;
      box-shadow: var(--shadow-md, 0 4px 6px -1px rgba(0,0,0,0.08), 0 2px 4px -1px rgba(0,0,0,0.04));
    }
    .app-header .brand-row { display:flex; align-items:center; gap:12px; }
    .app-header .logo-img { width:44px; height:44px; object-fit:contain; border-radius:10px; background:var(--bg); border:1px solid var(--line); }
    .app-header .badge-main {
      display:inline-flex; align-items:center;
      background: var(--subject-color);
      color: white;
      font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;
      padding:3px 8px; border-radius:99px;
    }

</style>
</head>

<body>

<header class="app-header">
  <div class="brand-row">
    <img src="chatisthisreal.png" alt="Logo" class="logo-img" onerror="this.style.display='none'">
    <div class="badge-main">Deutsch</div>
  </div>
</header>

<header>
  <img src="chatistthisreal.png"
       onerror="this.onerror=null;this.src='chatisthisreal.png';"
       alt="Chat is this real?"
       class="meme">
  <span class="badge">âš¡ Speedrunde â€¢ Zeitformen â€¢ HoS â€¢ 60 Sekunden</span>
  <h1>Wie schnell bist du? ğŸ</h1>
  <p>60 Sekunden. Klick dich durch â€“ schnell & fair ğŸ˜„</p>
</header>

<main>
  <div class="card">
    <div class="row">
      <button class="btn" id="startBtn" type="button">Start ğŸš€</button>
      <div>Punkte: <b id="score">0</b></div>
      <div>Zeit: <b id="time">60</b>s</div>
      <span class="small">(keine direkten Wiederholungen)</span>
    </div>

    <div id="question"></div>
    <div id="answers"></div>

    <div id="resultBox"></div>

    <!-- Reaktionsspiel -->
    <section class="mini" id="miniGame" aria-label="Bonus-Spiel">
      <h3>ğŸ® Bonus-Spiel: Reaktion</h3>
      <div class="miniBox" id="rtBox" tabindex="0" role="button" aria-label="Reaktionsfeld">
        <span id="rtText">Start drÃ¼cken und wartenâ€¦ sobald es ROT ist: klicken!</span>
      </div>
      <div class="row">
        <button class="btn" id="rtStart" type="button">Start ğŸ¯</button>
        <button class="btn secondary" id="rtBack" type="button">ZurÃ¼ck â†©ï¸</button>
      </div>
      <div class="small">Wenn du zu frÃ¼h klickst â†’ â€Zu frÃ¼h!â€œ ğŸ˜…</div>
    </section>
  </div>
</main>

<script>
/* ================== DOM / STATE ================== */
const startBtn = document.getElementById("startBtn");
const questionEl = document.getElementById("question");
const answersEl = document.getElementById("answers");
const scoreEl = document.getElementById("score");
const timeEl = document.getElementById("time");
const resultBox = document.getElementById("resultBox");

/* Mini-Game */
const miniGame = document.getElementById("miniGame");
const rtBox = document.getElementById("rtBox");
const rtText = document.getElementById("rtText");
const rtStart = document.getElementById("rtStart");
const rtBack = document.getElementById("rtBack");

let running = false;
let score = 0;
let time = 60;
let timer = null;
let current = null;

const timeformOptions = ["PrÃ¤sens","PrÃ¤teritum","Perfekt","Plusquamperfekt","Futur I","Futur II"];

/* ================== FRAGENPOOL (GROÃŸ) ================== */
const pool = [
  // ---- pick: Zeitform wÃ¤hlen ----
  // PrÃ¤sens
  {type:"pick", text:"Ich gehe morgen spazieren.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Wir lernen jetzt fÃ¼r den Test.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Jeden Montag spiele ich FuÃŸball.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Im Winter schneit es oft.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Heute Abend sehe ich einen Film.", answer:"PrÃ¤sens"},
  {type:"pick", text:"NÃ¤chste Woche schreibe ich eine Schularbeit.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Die Erde dreht sich um die Sonne.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Ich komme gleich!", answer:"PrÃ¤sens"},
  {type:"pick", text:"Wir treffen uns um 18 Uhr.", answer:"PrÃ¤sens"},
  {type:"pick", text:"Jetzt regnet es.", answer:"PrÃ¤sens"},

  // PrÃ¤teritum
  {type:"pick", text:"Ich ging nach Hause.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Er war gestern sehr mÃ¼de.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Wir hatten keine Zeit.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Sie schrieb einen Brief.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Der Hund bellte die ganze Nacht.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Wir spielten im Park.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Es gab ein Problem.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Ich wusste das schon.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Sie las das Buch in einem Zug.", answer:"PrÃ¤teritum"},
  {type:"pick", text:"Ich fand den SchlÃ¼ssel nicht.", answer:"PrÃ¤teritum"},

  // Perfekt
  {type:"pick", text:"Ich habe gegessen.", answer:"Perfekt"},
  {type:"pick", text:"Wir sind gelaufen.", answer:"Perfekt"},
  {type:"pick", text:"Sie hat den Film gesehen.", answer:"Perfekt"},
  {type:"pick", text:"Ich bin zu spÃ¤t gekommen.", answer:"Perfekt"},
  {type:"pick", text:"Wir haben lange gewartet.", answer:"Perfekt"},
  {type:"pick", text:"Er hat seine Jacke vergessen.", answer:"Perfekt"},
  {type:"pick", text:"Ich habe die Aufgabe verstanden.", answer:"Perfekt"},
  {type:"pick", text:"Sie ist schnell eingeschlafen.", answer:"Perfekt"},
  {type:"pick", text:"Ich bin nach Hause gegangen.", answer:"Perfekt"},
  {type:"pick", text:"Wir sind umgezogen.", answer:"Perfekt"},

  // Plusquamperfekt
  {type:"pick", text:"Ich hatte gegessen, bevor ich ging.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Wir waren schon gegangen, als er ankam.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Nachdem wir gegessen hatten, gingen wir raus.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Ich hatte den Bus verpasst, deshalb kam ich zu spÃ¤t.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Er war eingeschlafen, bevor der Film zu Ende war.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Er war schon losgefahren, als ich anrief.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Sie hatte ihre SchlÃ¼ssel verloren und rief mich an.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Wir hatten schon begonnen, als du gekommen bist.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Ich hatte das Heft zu Hause vergessen.", answer:"Plusquamperfekt"},
  {type:"pick", text:"Wir hatten gewonnen, bevor der Schiri abpfiff.", answer:"Plusquamperfekt"},

  // Futur I
  {type:"pick", text:"Ich werde lernen.", answer:"Futur I"},
  {type:"pick", text:"Wir werden das schaffen.", answer:"Futur I"},
  {type:"pick", text:"Er wird jetzt zu Hause sein.", answer:"Futur I"},
  {type:"pick", text:"Es wird gleich regnen.", answer:"Futur I"},
  {type:"pick", text:"Wir werden spÃ¤ter telefonieren.", answer:"Futur I"},
  {type:"pick", text:"Ich werde dir helfen.", answer:"Futur I"},
  {type:"pick", text:"Du wirst das schon kÃ¶nnen.", answer:"Futur I"},
  {type:"pick", text:"Das wird schon passen.", answer:"Futur I"},
  {type:"pick", text:"Wir werden nÃ¤chstes Jahr nach Berlin fahren.", answer:"Futur I"},
  {type:"pick", text:"Bald wirst du lachen.", answer:"Futur I"},

  // Futur II
  {type:"pick", text:"Ich werde gelernt haben.", answer:"Futur II"},
  {type:"pick", text:"Bis morgen wirst du das erledigt haben.", answer:"Futur II"},
  {type:"pick", text:"Er wird wohl schon gegangen sein.", answer:"Futur II"},
  {type:"pick", text:"In einer Stunde werde ich die Aufgabe gelÃ¶st haben.", answer:"Futur II"},
  {type:"pick", text:"Bis 18 Uhr werden wir alles vorbereitet haben.", answer:"Futur II"},
  {type:"pick", text:"Wenn du ankommst, werde ich schon gekocht haben.", answer:"Futur II"},
  {type:"pick", text:"Er wird die Nachricht bereits gelesen haben.", answer:"Futur II"},
  {type:"pick", text:"Um diese Zeit morgen wirst du lÃ¤ngst angekommen sein.", answer:"Futur II"},
  {type:"pick", text:"Bis nÃ¤chste Woche werden wir den Stoff wiederholt haben.", answer:"Futur II"},
  {type:"pick", text:"Sie wird das bestimmt vergessen haben.", answer:"Futur II"},

  // ---- tf: Richtig/Falsch ----
  {type:"tf", text:"Ich hatte gegessen â†’ Perfekt", correct:false},
  {type:"tf", text:"Ich habe gegessen â†’ Perfekt", correct:true},
  {type:"tf", text:"Wir sind gelaufen â†’ Perfekt", correct:true},
  {type:"tf", text:"Ich ging nach Hause â†’ PrÃ¤teritum", correct:true},
  {type:"tf", text:"Er wird wohl schon gegangen sein â†’ Futur II", correct:true},
  {type:"tf", text:"Ich werde lernen â†’ Futur II", correct:false},
  {type:"tf", text:"Bis morgen wirst du das erledigt haben â†’ Futur II", correct:true},
  {type:"tf", text:"NÃ¤chste Woche schreibe ich eine Schularbeit â†’ Futur I", correct:false},
  {type:"tf", text:"Er war mÃ¼de â†’ PrÃ¤teritum", correct:true},
  {type:"tf", text:"Wir hatten gewonnen â†’ Plusquamperfekt", correct:true},
  {type:"tf", text:"Ich bin gekommen â†’ PrÃ¤teritum", correct:false},
  {type:"tf", text:"Ich werde dir helfen â†’ Futur I", correct:true},

  // ---- use: Verwendung ----
  {type:"use", text:"Er wird jetzt zu Hause sein.", choices:["Zukunft","Vermutung (Gegenwart)","Vorvergangenheit"], answer:"Vermutung (Gegenwart)"},
  {type:"use", text:"Er wird wohl schon gegangen sein.", choices:["Zukunft","Vermutung (Vergangenheit)","Gewohnheit"], answer:"Vermutung (Vergangenheit)"},
  {type:"use", text:"Ich gehe morgen zum Arzt.", choices:["Plan/Zukunft","Vermutung","Vorvergangenheit"], answer:"Plan/Zukunft"},
  {type:"use", text:"Ich habe gegessen.", choices:["gesprochenes Deutsch","Vorvergangenheit","Zukunft"], answer:"gesprochenes Deutsch"},
  {type:"use", text:"Ich ging nach Hause.", choices:["ErzÃ¤hlzeit","Vermutung","Zukunft"], answer:"ErzÃ¤hlzeit"},
  {type:"use", text:"Ich hatte gegessen, bevor ich ging.", choices:["Vorvergangenheit","Zukunft","Gegenwart"], answer:"Vorvergangenheit"},
  {type:"use", text:"In einer Stunde werde ich die Aufgabe gelÃ¶st haben.", choices:["abgeschlossen bis dann","Gewohnheit","Gegenwart"], answer:"abgeschlossen bis dann"},
  {type:"use", text:"Ich werde morgen frÃ¼her aufstehen.", choices:["Plan/Zukunft","ErzÃ¤hlzeit","Vorvergangenheit"], answer:"Plan/Zukunft"}
];

/* ================== HELFER ================== */
function shuffleInPlace(arr){
  for(let i = arr.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* ====== Deck-System: keine direkten Wiederholungen ====== */
let deck = [];
function refillDeck(){
  deck = shuffleInPlace([...Array(pool.length).keys()]);
}
function pickQuestion(){
  if(deck.length === 0) refillDeck();
  const idx = deck.pop();
  return pool[idx];
}

/* ================== QUIZ-LOGIK ================== */
function mkBtn(text){
  const b = document.createElement("button");
  b.className = "option";
  b.type = "button";
  b.textContent = text;
  b.onclick = () => choose(text, b);
  answersEl.appendChild(b);
}

function renderQuestion(){
  current = pickQuestion();
  answersEl.innerHTML = "";

  if(current.type === "tf"){
    questionEl.innerHTML = "âš¡ <b>Richtig oder falsch?</b><br>" + current.text;
    ["Richtig","Falsch"].forEach(mkBtn);
  }
  else if(current.type === "use"){
    questionEl.innerHTML = "ğŸ¯ <b>WofÃ¼r wirdâ€™s verwendet?</b><br>" + current.text;
    // leicht mischen
    const choices = shuffleInPlace([...current.choices]);
    choices.forEach(mkBtn);
  }
  else {
    questionEl.textContent = current.text;
    const opts = shuffleInPlace([...timeformOptions]);
    opts.forEach(mkBtn);
  }
}

function choose(val, btn){
  if(!running) return;

  const allBtns = Array.from(answersEl.querySelectorAll("button"));
  allBtns.forEach(b => b.disabled = true);

  const correctVal = (current.type === "tf")
    ? (current.correct ? "Richtig" : "Falsch")
    : current.answer;

  if(val === correctVal){
    score++;
    scoreEl.textContent = score;
    btn.classList.add("ok");
  } else {
    btn.classList.add("no");
    const right = allBtns.find(b => b.textContent === correctVal);
    if(right) right.classList.add("ok");
  }

  setTimeout(() => {
    if(running) renderQuestion();
  }, 320);
}

function start(){
  score = 0;
  time = 60;
  scoreEl.textContent = "0";
  timeEl.textContent = "60";
  resultBox.style.display = "none";
  miniGame.style.display = "none";

  running = true;
  refillDeck();      // Start immer mit frischem Mix
  renderQuestion();

  clearInterval(timer);
  timer = setInterval(() => {
    time--;
    timeEl.textContent = String(time);
    if(time <= 0) finish();
  }, 1000);
}

function finish(){
  running = false;
  clearInterval(timer);

  questionEl.textContent = "";
  answersEl.innerHTML = "";

  resultBox.style.display = "block";
  resultBox.innerHTML = `
    <b>Timeâ€™s up!</b><br>
    Score: <b>${score}</b><br><br>
    <button class="btn" id="bonusBtn" type="button">ğŸ® Bonus-Spiel starten</button>
  `;

  const bonusBtn = document.getElementById("bonusBtn");
  bonusBtn.addEventListener("click", () => {
    miniGame.style.display = "block";
    rtBox.focus();
  });
}

/* ================== MINI-GAME (REAKTION) ================== */
let rtTimer = null;
let goAt = 0;
let rtState = "idle"; // idle | waiting | go | done

function startRT(){
  clearTimeout(rtTimer);
  rtState = "waiting";
  rtBox.className = "miniBox wait";
  rtText.textContent = "Warteâ€¦ NICHT klicken ğŸ™ˆ";

  rtTimer = setTimeout(() => {
    rtState = "go";
    rtBox.className = "miniBox go";
    rtText.textContent = "JETZT! ğŸ”´";
    goAt = performance.now();
  }, 900 + Math.random() * 2400);
}

function clickRT(){
  if(rtState === "waiting"){
    clearTimeout(rtTimer);
    rtState = "done";
    rtBox.className = "miniBox wait";
    rtText.textContent = "Zu frÃ¼h! ğŸ˜… Nochmal!";
    return;
  }
  if(rtState === "go"){
    const ms = Math.round(performance.now() - goAt);
    rtState = "done";
    rtBox.className = "miniBox";
    rtText.textContent = ms + " ms âš¡";
  }
}

startBtn.addEventListener("click", start);
rtStart.addEventListener("click", startRT);
rtBack.addEventListener("click", () => miniGame.style.display = "none");
rtBox.addEventListener("click", clickRT);
rtBox.addEventListener("keydown", (e) => {
  if(e.key === "Enter" || e.key === " "){
    e.preventDefault();
    clickRT();
  }
});
</script>

</body>
</html>
